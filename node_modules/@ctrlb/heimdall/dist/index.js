var jo=Object.create;var Ft=Object.defineProperty;var Bo=Object.getOwnPropertyDescriptor;var qo=Object.getOwnPropertyNames;var Oo=Object.getPrototypeOf,Ho=Object.prototype.hasOwnProperty;var _o=(i,e)=>()=>(i&&(e=i(i=0)),e);var _r=(i,e)=>{for(var t in e)Ft(i,t,{get:e[t],enumerable:!0})},Ur=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of qo(e))!Ho.call(i,o)&&o!==t&&Ft(i,o,{get:()=>e[o],enumerable:!(r=Bo(e,o))||r.enumerable});return i};var S=(i,e,t)=>(t=i!=null?jo(Oo(i)):{},Ur(e||!i||!i.__esModule?Ft(t,"default",{value:i,enumerable:!0}):t,i)),$r=i=>Ur(Ft({},"__esModule",{value:!0}),i);var ro={};_r(ro,{default:()=>v});var v,oo=_o(()=>{v=class{static isValid(e){if(e===null)return!0;switch(e.type){case"Program":return e.body.every(v.isValid);case"EmptyStatement":return!0;case"ExpressionStatement":return v.isValid(e.expression);case"BlockStatement":return e.body.every(v.isValid);case"LabeledStatement":return v.isValid(e.body);case"AssignmentExpression":case"CallExpression":case"FunctionExpression":case"NewExpression":case"UpdateExpression":return!1;case"Identifier":case"Literal":case"ThisExpression":return!0;case"ArrayExpression":return e.elements.every(v.isValid);case"BinaryExpression":case"LogicalExpression":return v.isValid(e.left)&&v.isValid(e.right);case"ConditionalExpression":return v.isValid(e.test)&&v.isValid(e.alternate)&&v.isValid(e.consequent);case"MemberExpression":return v.isValid(e.object)&&v.isValid(e.property);case"ObjectExpression":return e.properties.every(t=>v.isValid(t.value));case"SequenceExpression":return e.expressions.every(v.isValid);case"UnaryExpression":return v.isValid(e.argument);case"SpreadElement":return v.isValid(e.argument);case"TemplateLiteral":return e.quasis.every(v.isValid)&&e.expressions.every(v.isValid);case"TaggedTemplateExpression":return v.isValid(e.tag)&&v.isValid(e.quasi);case"TemplateElement":return!0;default:return!1}}}});var Pi={};_r(Pi,{get:()=>Ai,start:()=>vi,stop:()=>Ei});module.exports=$r(Pi);var a={agent:{apiKey:"ATLAS_APIKEY",autoInstrumentation:"ATLAS_AUTO_INSTRUMENTATION_ENABLE",logLevel:"ATLAS_LOG_LEVEL",disable:"ATLAS_DISABLE",silent:"ATLAS_SILENT",rejectOnStartup:"ATLAS_REJECT_ON_STARTUP"},broker:{host:"ATLAS_BROKER_HOST",port:"ATLAS_BROKER_PORT",client:"ATLAS_BROKER_CLIENT"},application:{tag:"ATLAS_APPLICATION_TAG",id:"ATLAS_APPLICATION_ID",name:"ATLAS_APPLICATION_NAME",version:"ATLAS_APPLICATION_VERSION",stage:"ATLAS_APPLICATION_STAGE"},debugApi:{enableAsyncCallStack:"ATLAS_ENABLE_ASYNC_CALLSTACK",cleanupAsyncCallStackInterval:"ATLAS_CLEANUP_ASYNC_CALLSTACK_INTERVAL",resetV8Debugger:"ATLAS_RESET_V8_DEBUGGER",resetV8DebuggerThreshold:"ATLAS_RESET_V8_DEBUGGER_THRESHOLD"},scriptStore:{hashCheckEnable:"ATLAS_HASH_CHECK_ENABLE",whilelistModule:"ATLAS_WHILELIST_MODULE",disablePositionCache:"ATLAS_DISABLE_POSITION_CACHE",prefix:"ATLAS_SCRIPT_PREFIX"},rateLimit:{inMinute:"ATLAS_RATE_LIMIT_IN_MINUTE"},capture:{maxFrames:"ATLAS_MAX_FRAMES",maxExpandFrames:"ATLAS_MAX_EXPAND_FRAMES",maxProperties:"ATLAS_MAX_PROPERTIES",maxParseDepth:"ATLAS_MAX_PARSE_DEPTH",propertyAccessClassification:"ATLAS_PROPERTY_ACCESS_CLASSIFICATION"},sourceCode:{minified:"ATLAS_SOURCE_CODE_MINIFIED"},taskExecutionQueue:{concurrency:"ATLAS_TASK_EXECUTION_QUEUE_CONCURRENCY",maxSize:"ATLAS_TASK_EXECUTION_MAX_SIZE"},dataReduction:{captureFrame:"captureFrame",logMessage:"logMessage"},errorCollection:{enable:"ATLAS_ERROR_COLLECTION_ENABLE",captureFrame:"ATLAS_ERROR_COLLECTION_CAPTURE_FRAME",rateLimit:{pointInMinute:"ATLAS_ERROR_COLLECTION_RATE_LIMIT_POINT_IN_MINUTE",totalInMinute:"ATLAS_ERROR_COLLECTION_RATE_LIMIT_TOTAL_IN_MINUTE"}}},Vr={silent:a.agent.silent,maxFrames:a.capture.maxFrames,maxExpandFrames:a.capture.maxExpandFrames,maxProperties:a.capture.maxProperties,maxParseDepth:a.capture.maxParseDepth,errorCollectionEnable:a.errorCollection.enable,errorCollectionEnableCaptureFrame:a.errorCollection.captureFrame};var jt=class{constructor(e){this.session=e}setSession(e){this.session=e}post(e,t,r){let o=(...s)=>{r!==void 0&&r(...s)};if(this.session===null){r!==void 0&&r(new Error("No debug session"),null);return}this.session.post(e,t,o)}setBreakpointByUrl(e){let t={};return this.post("Debugger.setBreakpointByUrl",e,(r,o)=>{r&&(t.error=r),t.response=o}),t}removeBreakpoint(e){let t={};return this.post("Debugger.removeBreakpoint",{breakpointId:e},r=>{r&&(t.error=r)}),t}updateBreakpointByUrl(e,t){let r=this.removeBreakpoint(e);return r.error?r:this.setBreakpointByUrl(t)}evaluateOnCallFrame(e){let t={};return this.post("Debugger.evaluateOnCallFrame",e,(r,o)=>{r&&(t.error=r),t.response=o}),t}getProperties(e){let t={};return this.post("Runtime.getProperties",e,(r,o)=>{r&&(t.error=r),t.response=o}),t}};var Po=S(require("inspector"));var Yr=require("uuid"),Jr=require("uuid");var zr="3cda958c-e704-56ff-b519-ab2e3dc3ccb4",Bt=30,Uo=60*60*24,Tr=Uo/Bt,Gr=60*30,Wr=50,Xr=60*60*24,Qr=1e3,F="ERROR_PROBE_STORE_ID",Kr=["@dev0"],h={[a.broker.host]:{default:"wss://atlas.ctrlb.ai"},[a.broker.port]:{default:443},[a.agent.logLevel]:{default:"info"},[a.agent.disable]:{default:!1},[a.agent.silent]:{default:!1},[a.debugApi.resetV8Debugger]:{default:!0},[a.debugApi.resetV8DebuggerThreshold]:{default:100},[a.debugApi.enableAsyncCallStack]:{default:!1},[a.debugApi.cleanupAsyncCallStackInterval]:{default:30*1e3},[a.scriptStore.disablePositionCache]:{default:!1},[a.scriptStore.hashCheckEnable]:{default:!1},[a.rateLimit.inMinute]:{default:200},[a.capture.maxFrames]:{default:10,min:1,max:20},[a.capture.maxExpandFrames]:{default:1,min:1,max:5},[a.capture.maxProperties]:{default:100,min:1,max:500},[a.capture.maxParseDepth]:{default:5,min:1,max:15},[a.capture.propertyAccessClassification]:{default:"ENUMERABLE-OWN"},[a.sourceCode.minified]:{default:!1},[a.broker.client]:{default:"default"},[a.taskExecutionQueue.concurrency]:{default:5},[a.taskExecutionQueue.maxSize]:{default:10},[a.agent.rejectOnStartup]:{default:!1},[a.dataReduction.captureFrame]:{canEnv:!1},[a.dataReduction.logMessage]:{canEnv:!1},[a.errorCollection.enable]:{default:!1},[a.errorCollection.captureFrame]:{default:!1},[a.errorCollection.rateLimit.pointInMinute]:{default:10},[a.errorCollection.rateLimit.totalInMinute]:{default:100}};var y=class{static generateId(){return(0,Yr.v4)()}static generareIdFrom(e){return(0,Jr.v5)(e,zr)}static generateShortId(){return y.generateId().substring(0,8)}};var io=S(require("acorn"));var Q=class extends Error{constructor(e=""){super(e)}},ce=class extends Error{constructor(e=""){super(e)}},K=class extends Error{constructor(e=""){super(e)}},Y=class extends Error{constructor(e=""){super(e)}},M=class extends Error{constructor(e=""){super(e)}},D=class extends Error{constructor(e=""){super(e)}},N=class extends Error{constructor(e=""){super(e)}},J=class extends Error{constructor(e=""){super(e)}},le=class extends Error{constructor(e=""){super(e)}},j=class extends Error{constructor(e=""){super(e)}},pe=class extends Error{constructor(e=""){super(e)}},B=class extends Error{constructor(e=""){super(e)}},ue=class extends Error{constructor(e=""){super(e)}},q=class extends Error{constructor(e=""){super(e)}},me=class extends Error{constructor(e=""){super(e)}},O=class extends Error{constructor(e=""){super(e)}},Pe=class extends Error{constructor(e=""){super(e)}},qt=class extends Error{constructor(e=""){super(e)}};var $o={[Q.name]:{code:3e3,message:"Logpoint has been already added in file {} on line {} from client {}"},[ce.name]:{code:3001,message:"No logpoint could be found in file {} on line {} from client {}"},[K.name]:{code:3002,message:"File name is mandatory"},[Y.name]:{code:3003,message:"Line number is mandatory"},[M.name]:{code:3004,message:"No logpoint could be found with id {} from client {}"},[D.name]:{code:3005,message:"Client {} has no access to logpoint with id {}"},[N.name]:{code:3050,message:"Error occurred while putting logpoint to file {} on line {} from client {}: {}"},[J.name]:{code:3051,message:"Source code mismatch detected while putting logpoint to file {fileName} on line {lineNo} from client {client} {reason}"},[le.name]:{code:3100,message:"Error occurred while updating logpoint to file {} on line {} from client {}: {}"},[j.name]:{code:3101,message:"Error occurred while updating logpoint with id {} from client {}: {}"},[pe.name]:{code:3150,message:"Error occurred while removing logpoint from file {} on line {} from client {}: {}"},[B.name]:{code:3151,message:"Error occurred while removing logpoint with id {} from client {}: {}"},[ue.name]:{code:3200,message:"Error occurred while enabling logpoint to file {} on line {} from client {}: {"},[q.name]:{code:3201,message:"Error occurred while enabling logpoint with id {} from client {}: {}"},[me.name]:{code:3250,message:"Error occurred while disabling logpoint to file {} on line {} from client {}: {}"},[O.name]:{code:3251,message:"Error occurred while disabling logpoint with id {} from client {}: {}"}},Zr=$o;var Vo={[Q.name]:{code:2e3,message:"Tracepoint has been already added in file {fileName} on line {lineNo} from client {client}"},[ce.name]:{code:2001,message:"No tracepoint could be found in file {fileName} on line {lineNo} from client {client}"},[K.name]:{code:2002,message:"File name is mandatory"},[Y.name]:{code:2003,message:"Line number is mandatory"},[M.name]:{code:2004,message:"No tracepoint could be found with id {id} from client {client}"},[D.name]:{code:2005,message:"Client {client} has no access to tracepoint with id {id}"},[N.name]:{code:2050,message:"Error occurred while putting tracepoint to file {fileName} on line {lineNo} from client {client}"},[J.name]:{code:2051,message:"Source code mismatch detected while putting tracepoint to file {fileName} on line {lineNo} from client {client} {reason}"},[le.name]:{code:2100,message:"Error occurred while updating tracepoint at file {fileName} on line {lineNo} from client {client} {reason}"},[j.name]:{code:2101,message:"Error occurred while updating tracepoint with id {id} from client client {client} {reason}"},[pe.name]:{code:2150,message:"Error occurred while removing tracepoint from file {fileName} on line {lineNo} from client {client} {reason}"},[B.name]:{code:2151,message:"Error occurred while removing tracepoint with id {id} from client client {client} {reason}"},[ue.name]:{code:2200,message:"Error occurred while enabling tracepoint at file {fileName} on line {lineNo} from client {client} {reason}"},[q.name]:{code:2201,message:"Error occurred while enabling tracepoint with {id} from client client {client} {reason}"},[me.name]:{code:2250,message:"Error occurred while disabling tracepoint at file {fileName} on line {lineNo} from client {client} {reason}"},[O.name]:{code:2251,message:"Error occurred while disabling tracepoint with {id} from client client {client} {reason}"}},eo=Vo;var to={...Zr,...eo};var $=class extends Error{constructor(t,r){super(r);this.code=t}};var H=class{static isPrimitive(e){return e==="undefined"||e==="boolean"||e==="number"||e==="string"||e==="symbol"}static isObject(e){return e&&typeof e=="object"}static isArray(e){return Array.isArray(e)}static isFunction(e){return e==="function"}static castToType(e,t){if(!H.isPrimitive(t)||e=="")return e;let r=e;try{switch(t){case"number":r=typeof e=="string"?Number(e):e;break;case"boolean":r=typeof e=="string"?e==="true":e;break}}finally{return r}}};var we=class extends Error{constructor(e){super(e)}};var P=class{static init(e,t){P.configMetadata=e&&e.configMetaData||{};let r=e&&e.config||{},o={};Object.keys(P.configMetadata).forEach(s=>{let c=P.configMetadata[s],l=c.key,d=c.default,g=c.required,x=c.type,f=c.canEnv;if(!r[l]&&f!=!1){let k=process.env[s];x==="map"?Object.keys(process.env).forEach(b=>{if(b.startsWith(s)){r[l]||(r[l]={});let ie=b.substring(s.length,b.length);ie&&(r[l][ie.replace(/\.|_/g,"")]=process.env[b])}}):x==="array"?Object.keys(process.env).forEach(b=>{b.startsWith(s)&&(r[l]||(r[l]=[]),r[l].push(process.env[b]))}):k?o[l]=k:d&&(o[l]=d,s==a.application.name&&t&&(o[l]=t))}if(g&&!r[l]&&!o[l])throw new we(`Config: ${l} must be filled!`)}),P.config={...r,...o}}static get(e,t){let r=P.config[e]||(P.configMetadata[e]&&P.configMetadata[e].key?P.config[P.configMetadata[e].key]:void 0);if(r==null&&!P.configMetadata[e])return;let o=P.configMetadata[e].type,s=r;s==null&&(t!==void 0?s=t:P.configMetadata[e]&&(s=P.configMetadata[e].default));let c=s;return P.configMetadata[e].get&&(c=P.configMetadata[e].get(s)),H.castToType(c,o)}static update(e){let t=!1,r={};Object.keys(e||{}).forEach(o=>{let s=Vr[o];if(s){let c=P.configMetadata[s]?P.configMetadata[s].key:void 0;c&&P.config[c]!=e[c]&&(P.config[c]=e[c],r[c]=e[c],t=!0)}}),t&&P.configChangedSubscribers.forEach(o=>{o(r)})}static subscribeConfigChanged(e){P.configChangedSubscribers.add(e)}static unsubscribeConfigChanged(e){P.configChangedSubscribers.delete(e)}},u=P;u.configChangedSubscribers=new Set;var zo=(oo(),$r(ro)).default,m=class{static getProbeId(e){return`${e.type}:${e.id}`}static extractFileNameFrom(e,t){let r=e.indexOf(t);return r>=0&&(e=e.substring(r+t.length).split("?")[0]),e}static formatErrorMesage(e,t,r=""){try{let o=e;return(Object.keys(t)||[]).forEach(s=>{let c=new RegExp("\\{"+s+"\\}","gi");o=o.replace(c,t[s])}),r&&(o=o.replace("{reason}",r)),o}catch{return r||e}}static generateLocationId(e){return y.generareIdFrom(`${e.fileName}${e.lineNo}${e.client}`)}static validateCondition(e){if(e.condition){let t=io.parse(e.condition,{sourceType:"script",ecmaVersion:6});if(!zo.isValid(t))throw new qt(`Condition '${e.condition}' is not valid`)}}static getCodedError(e,t){return m.getCodedErrorByName(e.constructor.name,t,e.message)}static getCodedErrorByName(e,t,r){let o=to[e];if(!!o)return new $(o.code,m.formatErrorMesage(o.message,t,r))}static extractFileName(e){return m.extractFileNameFrom(e,"contents")}static fillProbeId(e){e.id=m.getProbeId(e)}static fillClientDefault(e){e.client||(e.client=u.get(a.broker.client))}static fillExpireSecsDefault(e){e.expireSecs>0?e.expireSecs=Math.min(e.expireSecs,Xr):e.expireSecs=Gr}static fillExpireCountDefault(e){e.expireCount>0?e.expireCount=Math.min(e.expireCount,Qr):e.expireCount=Wr}};var se=class{constructor(){this.locationMap=new Map,this.breakpointProbeMap=new Map,this.probeMap=new Map,this.tagProbeMap=new Map}getAllProbeContexts(){let e=[];for(let[t,r]of this.probeMap)t!==F&&e.push(r.getContext());return e}getAllProbes(){let e=[];for(let[t,r]of this.probeMap)t!==F&&e.push(r.getProbe());return e}get(e){return this.probeMap.get(e)}getProbeIds(e){return this.breakpointProbeMap.get(e)}getProbeIdsByLocationId(e){let t=this.locationMap.get(e);if(!!t)return this.breakpointProbeMap.get(t)}getProbeByTag(e){return this.tagProbeMap.get(e)}removeProbeTag(e){this.tagProbeMap.delete(e)}set(e,t){let r=t.getId(),o=t.getLocationId();return this.breakpointProbeMap.has(e)||(this.breakpointProbeMap.set(e,new Set),this.locationMap.set(o,e)),this.breakpointProbeMap.get(e).add(r),this.probeMap.set(r,t),(t.getContext().getTags()||[]).forEach(s=>{this.tagProbeMap.has(s)||this.tagProbeMap.set(s,new Set),this.tagProbeMap.get(s).add(r)}),!0}delete(e){if(this.probeMap.has(e)){let t=this.probeMap.get(e),r=t.getV8BreakpointId(),o=this.breakpointProbeMap.get(r);o&&(o.delete(e),o.size==0&&(this.breakpointProbeMap.delete(r),this.locationMap.delete(t.getLocationId()))),(t.getContext().getTags()||[]).forEach(s=>{let c=this.tagProbeMap.get(s);c&&(c.delete(e),c.size==0&&this.tagProbeMap.delete(s))}),this.probeMap.delete(e)}}deleteExpiredProbes(){this.probeMap.forEach(e=>{e.getContext().isExpired()&&this.delete(e.getId())})}clear(){this.breakpointProbeMap.clear(),this.locationMap.clear(),this.probeMap.clear()}isV8BreakpointExistOnLocation(e){let t=m.generateLocationId(e);return this.locationMap.has(t)}isV8BreakpointExist(e){return this.breakpointProbeMap.has(e)}findV8Breakpoint(e){let t=m.generateLocationId(e);return this.locationMap.get(t)}};var mo=S(require("fs")),Se=S(require("path")),go=S(require("source-map"));var no=require("atob"),Go=require("url"),Wo=require("path"),Xo=require("decode-uri-component");function Qo(...i){return Array.prototype.reduce.call(arguments,function(e,t){return Go.resolve(e,t)})}function Ko(i){return Wo.sep==="\\"?i.replace(/\\/g,"/").replace(/^[a-z]:\/?/i,"/"):i}function Yo(i){return Xo(i.replace(/\+/g,"%2B"))}function ao(i,e){try{return JSON.parse(i.replace(/^\)\]\}'/,""))}catch(t){throw t.sourceMapData=e,t}}function Jo(i,e,t){var r=Yo(e);try{return String(i(r))}catch(o){throw o.sourceMapData=t,o}}var so=/[#@] sourceMappingURL=([^\s'"]*)/,Zo=RegExp(`(?:/\\*(?:\\s*\r?
(?://)?)?(?:`+so.source+")\\s*\\*/|//(?:"+so.source+"))\\s*");function ei(i){var e=i.match(Zo);return e?e[1]||e[2]||"":null}function co(i,e,t){var r=ni(i,e);return!r||r.map||(r.map=Jo(t,r.url,r),r.map=ao(r.map,r)),r}var ti=/^data:([^,;]*)(;[^,;]*)*(?:,(.*))?$/,ri=/^(?:application|text)\/json$/,oi="utf-8";function ii(i){for(var e=no(i),t=e.length,r=new Uint8Array(t),o=0;o<t;o++)r[o]=e.charCodeAt(o);return r}function si(i){if(typeof TextDecoder>"u"||typeof Uint8Array>"u")return no(i);var e=ii(i),t=new TextDecoder(oi,{fatal:!0});return t.decode(e)}function ni(i,e){e=Ko(e);var t=ei(i);if(!t)return null;var r=t.match(ti);if(r){var o=r[1]||"text/plain",s=r[2]||"",c=r[3]||"",l={sourceMappingURL:t,url:null,sourcesRelativeTo:e,map:c};if(!ri.test(o)){var d=new Error("Unuseful data uri mime type: "+o);throw d.sourceMapData=l,d}try{l.map=ao(s===";base64"?si(c):decodeURIComponent(c),l)}catch(x){throw x.sourceMapData=l,x}return l}var g=Qo(e,t);return{sourceMappingURL:t,url:g,sourcesRelativeTo:g,map:null}}var ci=require("crypto"),ke=class{static generateSHA256(e){return ci.createHash("sha256").update(e).digest("hex")}};var Z=S(require("path")),Ot=process.cwd(),li=Ot.length+1,lo="file://",po="file:///",pi=RegExp(`^${po}[a-zA-Z]+:`),A=class{static getAbsolutePath(e){return Z.isAbsolute(e)?e:Z.join(Ot,e)}static getFileExtention(e){return Z.extname(e)}static getRoutePath(e){return e.replace(Ot,"")}static canonizeFileName(e){return Z.normalize(e.replace(/[\\\/]/g,"/"))}static stripFileProtocol(e){let t=e.toLowerCase();return pi.test(t)?e.substr(po.length):t.startsWith(lo)?e.substr(lo.length):e}static stripCurrentWorkingDirectory(e){return A.stripFileProtocol(e).substr(li)}static resolveRelativePath(e){return A.stripCurrentWorkingDirectory(e)}static isPathInCurrentWorkingDirectory(e){return A.stripFileProtocol(e).indexOf(Ot)===0}static isPathInNodeModulesDirectory(e){return A.stripFileProtocol(e).indexOf("node_modules")===0}};var uo=S(require("url")),de=class{static getFilePath(e){return uo.fileURLToPath(e)}static isEncoded(e){return e=e||"",e!==decodeURIComponent(e)}};var ge=class{static isWindows(){return process.platform==="win32"}};var V=require("npmlog");V.addLevel("debug",1600,{fg:"green"});V.level=process.env[a.agent.logLevel]?process.env[a.agent.logLevel].toLowerCase():"info";V.disableColor();var n={setLogLevel:i=>{V.level=i},info:i=>{V.info("",i)},warn:i=>{V.warn("",i)},debug:i=>{V.debug("",i)},error:(i,e)=>{e?V.error("",i,e):V.error("",i)}};var fo=S(require("lru-cache")),Nr=class{constructor(e,t,r,o){this.id=e,this.sourceFileInfoMap=new Map,this.rawFilename=t,this.rawFilePath=this.getRawFilePath(this.rawFilename),this.rawFileRelativePath=this.getRawFileRelativePath(this.rawFilePath),this.filename=this.rawFilename.startsWith("file:")?A.canonizeFileName(de.getFilePath(this.rawFilename)):A.canonizeFileName(this.rawFilename),this.fileHash=this.generateSourceHash(r),this.mapConsumer=null,this.loadMap(r,o)}isCompatableWithFile(e){return!(this.fileHash&&e.replace(/(\r\n|\n|\r)/gm,"")!==this.fileHash)}partitionString(e,t){let r=-1,o=2;for(let s=0;s<o&&(r=e.indexOf(t,r+1),r!==-1);s++);if(r!==-1){let s=e.slice(0,r),c=t,l=e.slice(r+t.length);return c+l}return""}findSourceFileInfo(e){for(;e!="";){let t=this.sourceFileInfoMap.get(e);if(t)return t;e=this.partitionString(e,"/")}}generatedPositionFor(e,t){if(!this.mapConsumer||!e||!t)return;let r=this.sourceFileInfoMap.get(e);if(!r)return;let o=this.mapConsumer.generatedPositionFor({source:r.sourceFile,line:t+1,column:0});return o?{...o,path:r.sourceFile}:void 0}loadMap(e,t){if(!this.filename||!e)return;n.debug(`<ScriptStoreData> Loading source for ${this.filename} ...`);let r=null;try{r=co(e,this.filename,mo.default.readFileSync)}catch{n.debug(`<ScriptStoreData> Unable to find source map ${this.filename}`)}if(r){if(r.map){let o=r.map;this.mapConsumer=new go.SourceMapConsumer(o);for(let s of o.sources){let c=s,l=this.mapConsumer;l.file&&(c=Se.default.join(this.filename.replace(l.file,""),s));let d=A.getRoutePath(c);this.sourceFileInfoMap.set(t?Se.default.join(t,d):d,{rawPath:this.rawFilename,rootPath:d,sourceFile:s})}}}else{let o=A.getRoutePath(this.filename);this.sourceFileInfoMap.set(t?Se.default.join(t,o):o,{rawPath:this.rawFilename,rootPath:o,sourceFile:this.filename})}}generateSourceHash(e){return e===null?e:(e=(ge.isWindows()?e.replace(/\r\n/g,`
`):e.replace(`\r
`,`
`)).replace(`\r\0
\0`,`
\0`).replace("\r",`
`),ke.generateSHA256(e))}getRawFilePath(e){let t=A.stripFileProtocol(e);return ge.isWindows()?t.replace(/\//g,"\\"):de.isEncoded(t)?decodeURIComponent(t):t}getRawFileRelativePath(e){return A.stripCurrentWorkingDirectory(e)}},Re=class{constructor(){this.scriptUrlMap=new Map,this.scriptMap=new Map,this.disablePositionCache=u.get(a.scriptStore.disablePositionCache,!1),this.scriptPrefix=this.appendSlash(u.get(a.scriptStore.prefix)),this.disablePositionCache||(this.positionLruCache=new fo.default({max:100,maxSize:100,ttl:1e3*60*5,allowStale:!1,updateAgeOnGet:!0,updateAgeOnHas:!0,sizeCalculation:(e,t)=>1}))}get(e){return this.scriptMap.get(e)}has(e){return this.scriptMap.get(e)!=null}getScriptRawFilename(e){let t=this.scriptMap.get(e);return t?t.rawFilename:void 0}getScriptRawFilePath(e){let t=this.scriptMap.get(e);return t?t.rawFilePath:void 0}partitionString(e,t){let r=-1,o=2;for(let s=0;s<o&&(r=e.indexOf(t,r+1),r!==-1);s++);if(r!==-1){let s=e.slice(0,r),c=t,l=e.slice(r+t.length);return c+l}return""}getByScriptUrl(e){for(;e!="";){let t=this.scriptUrlMap.get(e);if(t&&t.scriptId)return this.scriptMap.get(t.scriptId);e=this.partitionString(e,"/")}}generatedPositionFor(e,t){let r=this.getByScriptUrl(e);if(!r)return;let o=r.findSourceFileInfo(e);if(!o)return;let s=`${e}-${t}`;if(this.disablePositionCache)return r.generatedPositionFor(o.rootPath,t);try{if(this.positionLruCache.has(s))return this.positionLruCache.get(s);{let c=r.generatedPositionFor(o.rootPath,t);return c&&this.positionLruCache.set(s,c),c}}catch{return r.generatedPositionFor(o.rootPath,t)}}set(e){if(e==null||e.scriptRawUrl==null||e.scriptRawUrl===""||e.scriptParams==null||this.scriptMap.hasOwnProperty(e.scriptParams.url))return;let t=e.scriptParams.scriptId,r=new Nr(t,e.scriptRawUrl,e.scriptSource,this.scriptPrefix);this.scriptMap.set(t,r),r.sourceFileInfoMap.forEach((o,s)=>{this.scriptUrlMap.set(s,{...o,scriptId:t})})}clear(){this.scriptUrlMap&&this.scriptUrlMap.clear(),this.scriptMap&&this.scriptMap.clear(),this.positionLruCache&&this.positionLruCache.clear()}appendSlash(e){if(!!e)return e.startsWith("/")?e:Se.default.join("/",e)}};var Ie=class{static isBlackListedModule(e){if(e.startsWith("native ")||e.startsWith("/var/runtime/"))return!0;let t=e.match(/\/node_modules\/(.*?)\//);if(t==null||t.length===0)return!1;let r=u.get(a.scriptStore.whilelistModule);if(r!==void 0){for(let o of r.replace(/['"]/g,"").split(";"))if(o===t[1])return!1}return!!ui.has(t[1])}},ui=new Set(["is-redirect","gulp-minify-css","strip-bom","d3-chord","magic-string","lodash.isempty","@material-ui","limiter","postcss-normalize-url","jmespath","jwt-simple","yeoman-environment","mongoose-legacy-pluralize","vfile","koa-convert","is-retry-allowed","opener","url-join","filesize","ansi-bgmagenta","spark-md5","d3-axis","babel-plugin-transform-export-extensions","path-platform","helmet-crossdomain","ember-cli-babel","@mrmlnc","webpack-bundle-analyzer","postcss-reporter","bmp-js","public-encrypt","ioredis","username-sync","koa-body","randombytes","aproba","lodash.clonedeep","globule","babel-plugin-transform-react-display-name","mathml-tag-names","buffer-equal-constant-time","listr-verbose-renderer","ordered-read-streams","has-flag","url-to-options","envinfo","execall","fast-future","buffer-crc32","minstache","koa-mount","node-pre-gyp","source-map-support","wreck","unyield","dev-ip","babel-helper-function-name","numeral","xmlcreate","object-visit","sparse-bitfield","dom-helpers","through2","async-each","connect-redis","gzip-size","mem","babel-polyfill","jasmine","eventlistener","rc-util","react-lifecycles-compat","merge-deep","lodash.memoize","path","passport-oauth1","postcss-import","interpret","streamsearch","get-assigned-identifiers","decompress-targz","detect-newline","imagemin-pngquant","sort-keys-length","is-finite","ember-cli-htmlbars","friendly-errors-webpack-plugin","component-classes","vinyl","@szmarczak","babel-register","fast-decode-uri-component","stackframe","lodash.isnumber","sliced","set-value","is-observable","expand-braces","single-line-log","ansi-magenta","ssh2-streams","prismjs","app-root-path","uniq","postcss-markdown","date-fns","bs58","blank-object","babel-plugin-transform-es2015-shorthand-properties","terser-webpack-plugin","fstream","sw-precache-webpack-plugin","prelude-ls","webpack","listr-silent-renderer","passport","ip","file-exists","react-clone-referenced-element","cli-cursor","winston-compat","@sindresorhus","lodash._escapehtmlchar","url-loader","binary","streamroller","har-validator","url-parse","ware","standard-as-callback","gulp-autoprefixer","regex-cache","stream-http","remove-bom-buffer","react-addons-css-transition-group","taskgroup","bin-build","xhr","p-locate","rc-align","ms","deprecated","hoist-non-react-statics","run-sequence","mz","jws","path-parse","fast-levenshtein","xml2json","sync-exec","ethjs-unit","postcss-env-function","spdx-correct","tfunk","tweetnacl","sqlstring","plist","absolute","d3-fetch","js-sha3","d3-quadtree","html-entities","rechoir","machine","ent","react-select","grunt-contrib-clean","requizzle","config","w3c-xmlserializer","import-fresh","localtunnel","karma-coverage","esutils","nwsapi","after","fs-readdir-recursive","window-size","react-deep-force-update","ansi-gray","first-chunk-stream","sparkles","arch","yargs-parser","continuation-local-storage","globby","rcfinder","bootstrap","jsonparse","scryptsy","lodash.defaults","js2xmlparser","lazy-cache","redent","buffer-more-ints","eslint-plugin-flowtype","is-number-object","case-sensitive-paths-webpack-plugin","over","vary","is-absolute-url","awesome-typescript-loader","imports-loader","section-matter","is-hex-prefixed","parse-passwd","underscore-contrib","@types","flagged-respawn","tar-fs","hasha","cli","nocache","httpntlm","dns-txt","regexpp","lodash.once","http-proxy-agent","gulp-htmlmin","gulp-shell","command-line-args","arr-union","rfdc","pretty-error","typescript","readable-stream","lodash.isinteger","p-try","broccoli-merge-trees","nodemon","constant-case","regex-not","spdx-exceptions","deep-defaults","invert-kv","unzip-response","querystring-es3","source-map-loader","deps-sort","postcss-dir-pseudo-class","hex-color-regex","socket.io-adapter","react-router-dom","is-number","lcid","aria-query","gulp-clean-css","loader-utils","pug-linker","babel-helper-explode-class","consolidate","pngjs","leveldown","map-age-cleaner","obuf","striptags","path-case","babel-plugin-transform-es2015-function-name","mqtt-packet","commist","fb-watchman","lodash._isiterateecall","long-timeout","rw","os-locale","xml-crypto","natural-compare","graphql-tag","rev-hash","postcss-normalize-positions","v8-compile-cache","rx","bs-recipes","jss-vendor-prefixer","p-event","js-git","sprintf","dotenv-expand","node-uuid","got","has-gulplog","delegate","log","parseurl","fast-redact","humanize-number","now-and-later","standard","snake-case","assertion-error","istextorbinary","rcloader","win-release","engine.io-client","bower-config","jsonfile","stylelint","uri-js","connect-mongo","shush","isurl","readline-sync","pascalcase","lowercase-keys","user","postcss-nesting","thenify","multicast-dns","ansi-yellow","scope-analyzer","fclone","es5-ext","babel-plugin-transform-async-generator-functions","pg-connection-string","inflight","mongodb-core","portscanner","uglify-js","through2-concurrent","camelcase","follow-redirects","ieee754","culvert","array-reduce","is-svg","num2fraction","level-errors","arr-flatten","rc-steps","csstype","copy-descriptor","urix","async-promise-queue","fancy-log","file-entry-cache","react-addons-test-utils","static-extend","parse-cache-control","package-json","caller-path","web3-eth-iban","jest-message-util","pluralize","raw-body","workbox-core","multiparty","array-each","enabled","restify","p-map","lodash.assign","url-parse-lax","character-reference-invalid","websocket","heimdalljs-logger","web3-core-promievent","react-input-autosize","ansi-white","setprototypeof","hash.js","secp256k1","jest-config","memorystream","x-xss-protection","to-no-case","path-root","map-cache","envify","babel-preset-flow","workbox-webpack-plugin","rc-slider","lodash-es","prettier-linter-helpers","css-what","w3c-hr-time","filenamify","make-error","glob","babel-plugin-transform-flow-strip-types","babel-plugin-syntax-trailing-function-commas","grunt-contrib-cssmin","forwarded","terminal-paginator","d3-drag","uuid","angular-ui-router","pixrem","cssesc","unist-util-visit","good-listener","regenerator-transform","abbrev","console-browserify","animate.css","postcss","dot","can-symlink","to-buffer","npm-run-path","type-is","error-ex","scrypt.js","lodash.escape","locate-path","colors","terser","gauge","hmac-drbg","restify-errors","web3-utils","bail","d3","eslint-plugin-react","ansi-green","big.js","postcss-preset-env","fs-write-stream-atomic","https-browserify","pathval","sugar","is-decimal","callsite","fs.realpath","are-we-there-yet","success-symbol","is-directory","is-module","end-of-stream","pug-attrs","ci-info","di","is-png","watch","node-gyp","stringify-object","detect-port-alt","pg-pool","react-modal","bunyan","requires-port","gonzales-pe","commondir","d3-hierarchy","blueimp-md5","combined-stream","typechecker","shallowequal","vue-template-compiler","change-emitter","d3-zoom","collapse-white-space","nunjucks","xpc-connection","rc-menu","babel-plugin-transform-es2015-literals","babel-plugin-syntax-jsx","d3-brush","mquery","radium","deep-equal","eslint-config-prettier","check-types","make-iterator","babelify","known-css-properties","dasherize","cssdb","wide-align","remark-stringify","postcss-svgo","flexbuffer","urllib","camel-case","killable","optparse","array-equal","lodash.isfinite","unist-util-visit-parents","graphql","constants-browserify","require-main-filename","es6-symbol","preserve","compress-commons","accord","babel-plugin-transform-es2015-computed-properties","extend","jest-changed-files","snapdragon-node","extract-text-webpack-plugin","copy-concurrently","rttc","inline-style-prefixer","is-ci","promisify-node","map-visit","warning-symbol","xhr2","rc-pagination","postcss-place","deep-eql","ansi-inverse","optimize-css-assets-webpack-plugin","coa","unicode-5.2.0","is-bluebird","then-request","component-bind","lodash.keys","deep-assign","global-dirs","@svgr","ast-types-flow","better-assert","node-notifier","style-loader","request-promise","passport-oauth2","map-stream","verror","pop-iterate","diff","d3-dispatch","intl-relativeformat","parley","block-stream","glob-watcher","clone-stats","fragment-cache","wiredep-cli","three","https-proxy-agent","native-duplexpair","serve-favicon","ethers","source-map-resolve","which-module","jest-worker","ansi-dim","saslprep","koa-logger","draft-js","md5.js","postcss-color-hex-alpha","postcss-focus-within","balanced-match","depd","has","js-levenshtein","broccoli-persistent-filter","is-regexp","regjsparser","lodash.isarray","is-unc-path","a-sync-waterfall","babel-messages","sax","functional-red-black-tree","easy-extender","maxmin","metro-cache","anchor","natives","reselect","postcss-flexbugs-fixes","dom-matches","base64-js","json-schema","proxy-from-env","is","cuid","faker","postcss-safe-parser","unirest","bodec","jest","grunt-cli","any-base","jest-runtime","growl","postcss-normalize-repeat-style","table-layout","concat-stream","has-values","filename-reserved-regex","xhr2-cookies","split","uglify-es","clear","sockjs","stat-mode","nib","internal-ip","babel-plugin-syntax-export-extensions","topo","ajv-keywords","useragent","boxen","cycle","postcss-merge-rules","is-gif","url-template","match-stream","function.prototype.name","messageformat","css-color-keywords","pac-resolver","react-router","parse-bmfont-ascii","minimist-options","eventemitter3","eventemitter2","istanbul-lib-instrument","is-lower-case","unified","typedarray-to-buffer","duplexer2","duplexer3","graceful-fs","cli-width","tty-browserify","clean-css","ansi-bgyellow","to-regex","color-convert","xmlhttprequest","arr-swap","load-json-file","debug","postcss-page-break","d3-shape","ansi-cyan","steno","d3-format","jsesc","rc-dialog","has-ansi","idna-uts46-hx","character-entities-html4","ansi-underline","for-in","domutils","import-cwd","phantomjs-prebuilt","mem-fs","word-wrap","webpack-hot-middleware","jsprim","select-hose","memoizee","opn","replace","math-expression-evaluator","import-lazy","parseqs","is-negative-zero","workerpool","react-event-listener","debounce","chartjs-color-string","pug-error","react-bootstrap","p-pipe","fs-extra","private","gulp-replace","postcss-color-rgba-fallback","prompt-radio","mute-stream","text-encoding","json3","linkify-it","browserify-zlib","common-tags","asn1.js","escape-html","escape-regexp","apollo-link","react-redux","supertest","jest-regex-util","ternary-stream","console-stream","complex.js","flatten","os-browserify","printj","postcss-gap-properties","lodash._shimkeys","cacheable-request","dtrace-provider","umd","postcss-font-variant","ssh2","is-installed-globally","parse-asn1","pm2-deploy","buffer-xor","lodash.merge","xmlchars","web3","hyphenate-style-name","cors","plugin-error","bin-version-check","remove-bom-stream","is-binary-path","file-uri-to-path","chownr","pino-std-serializers","qjobs","domelementtype","accepts","html-minifier","replace-ext","zen-observable-ts","node-version","plur","liftoff","pug-lexer","web3-net","babel-plugin-transform-es2015-duplicate-keys","detect-port","js-tokens","workbox-cacheable-response","react-slick","vfile-message","lodash-node","is-object","babel-preset-react-app","mocha","sort-keys","doctrine","formidable","is-supported-regexp-flag","npm-packlist","async-foreach","stream-combiner","lodash.omit","@vue","compression","noop-logger","jwt-decode","vue-template-es2015-compiler","one-time","ansi-wrap","to-arraybuffer","browser-sync","serve-index","editions","web3-core-requestmanager","textextensions","passport-oauth","pako","d3-time","safe-buffer","path-is-inside","filenamify-url","color-support","pgpass","escape-regexp-component","mathjs","change-case","merge-source-map","postcss-normalize-string","object-assign","ccount","detective","markdown-it","iniparser","form-data","union","htmlescape","react-router-redux","symbol-observable","trim","postcss-less","file-sync-cmp","sequelize","history","has-symbols","@samverschueren","falafel","jsbn","babel-plugin-debug-macros","stylehacks","bs58check","fetch-cookie","lodash._basevalues","browser-sync-client","sanitize-html","indx","is-jpg","css-unit-converter","prompt-actions","gulp-template","event-emitter","path-posix","child-process-promise","for-own","@emotion","babel-plugin-syntax-async-generators","promise-inflight","rxjs","fsevents","d3-time-format","fast-json-stable-stringify","node-gyp-build","event-loop-inspector","realpath-native","acorn-node","svg-tags","shasum","randomhex","helmet-csp","mkdirp","bn.js","repeat-string","escape-string-regexp","restore-cursor","react-transition-group","rc-checkbox","babel-types","sorted-array-functions","cssnano-util-raw-cache","timm","http-proxy-middleware","errlop","global","normalize-scroll-left","shebang-regex","koa-router","shellwords","sass-loader","reduce-function-call","cssnano-util-get-arguments","postcss-html","socks-proxy-agent","define-property","grunt-contrib-jshint","busboy","es-to-primitive","strip-outer","trim-trailing-lines","elliptic","decode-uri-component","browserify-sha3","web3-bzz","path-browserify","string","http-signature","koa-compose","tildify","zone.js","pstree.remy","enqueue","pm2-axon-rpc","intl-messageformat","has-generators","leven","react-addons-shallow-compare","gud","unique-random-array","boolbase","resolve-cwd","ansi-bgblack","puppeteer","lodash.pick","is-in-browser","safefs","array-includes","sockjs-client","add-dom-event-listener","isobject","xregexp","hexlet-pairs","css-color-function","prettyjson","prism-media","font-awesome","jsonschema","react-test-renderer","json2csv","find-up","fbemitter","http-response-object","cloneable-readable","brcast","rollup","mv","jest-mock","markdown-table","node-emoji","thunkify","is-my-ip-valid","postcss-replace-overflow-wrap","wiredep","lru-queue","browserify-rsa","spdy-transport","growly","babel-preset-fbjs","resolve-options","lower-case-first","hoopy","address","grouped-queue","move-concurrently","@serialport","normalize-url","isbinaryfile","lazy","should-type-adaptors","load-bmfont","thunkify-wrap","indent-string","lru-cache","upath","hbs","param-case","os","parallel-transform","stream-throttle","karma-webpack","babel-plugin-transform-es2015-modules-commonjs","marked","fluent-ffmpeg","cacache","urijs","env-paths","cli-truncate","mdurl","d3-transition","resp-modifier","quick-temp","rc-input-number","getobject","cookiejar","postcss-minify-gradients","pm2-multimeter","mssql","postgres-interval","dom-walk","untildify","default-gateway","https","http-https","spdx-expression-parse","clui","jest-haste-map","cluster-key-slot","gifsicle","safe-json-parse","cli-table-redemption","spdy","ienoopen","ts-loader","expand-template","glob2base","browserify-des","pleeease-filters","uniqs","caw","osx-release","meow","is-whitespace-character","hiredis","github-username","ignore-by-default","resize-observer-polyfill","domexception","is-plain-obj","es6-promisify","@csstools","alphanum-sort","pushdata-bitcoin","scss-tokenizer","chokidar","discontinuous-range","regexp-clone","cssnano","quote-stream","pkg-up","chai-as-promised","pino","pug-load","css-select-base-adapter","workbox-routing","cli-table2","write","foreach","rmc-feedback","nyc","array-from","react-dnd-html5-backend","postcss-color-function","slush","babel-cli","gtoken","karma-mocha","sinon","levn","babel-helper-optimise-call-expression","metro-minify-uglify","browserify","regexpu-core","scmp","docopt","natural","@babel","ua-parser-js","git-sha1","q","classnames","brorand","media-typer","lodash.flattendeep","babel-template","typical","ast-types","rc-calendar","postcss-reduce-initial","safe-regex","reinterval","detect-conflict","webpack-merge","git-node-fs","postcss-colormin","mimic-fn","stack-trace","electron-download","workbox-broadcast-cache-update","builtins","amqplib","memory-fs","platform","multiline","babel-plugin-transform-es2015-modules-systemjs","bcryptjs","postcss-modules-values","ecdsa-sig-formatter","is-number-like","scandirectory","csv-generate","babel-plugin-transform-es2015-parameters","lodash.camelcase","errorhandler","tinytim","gulp-imagemin","gulp-git","is-utf8","eslint-visitor-keys","xpipe","packet-reader","pug-runtime","watchify","crypto","eachr","ethereumjs-util","vinyl-buffer","co-from-stream","date-format","mysql2","nice-try","is-arrayish","react-motion","prompt-checkbox","crc32-stream","exenv","serve-static","gulplog","parse-bmfont-xml","is-alphanumeric","koa-send","named-placeholders","jest-environment-jsdom","dockerode","css-url-regex","electron-to-chromium","is-path-inside","external-editor","ejs","argx","tmpl","ansi-grey","redux-thunk","d3-array","d3-path","argv","@angular","uglify-to-browserify","mime","babel-preset-es2015","es6-denodeify","is-extendable","css-in-js-utils","rlp","ora","units-css","event-stream","regjsgen","resolve-path","mkdirp-promise","@protobufjs","http-deceiver","strip-ansi","jwa","imurmurhash","emotion","clone-deep","create-react-class","trim-newlines","character-parser","make-error-cause","babel-helper-define-map","filename-regex","miller-rabin","specificity","unc-path-regex","angular","expand-range","livereload-js","underscore.string","parseuri","should-format","node-modules-regexp","flatiron","bitcoin-ops","array-flatten","rc-tree-select","jss-nested","rx-lite-aggregates","h2x-plugin-jsx","gulp-install","prettier","p-limit","eyes","showdown","neo-async","google-auth-library","workbox-build","registry-auth-token","vorpal","concat-map","babel-plugin-syntax-function-bind","grunt","web3-providers-http","is-property","argsarray","stealthy-require","mysql","optimist","log-ok","omit.js","center-align","yallist","lodash.templatesettings","postcss-color-rgb","p-cancelable","getpass","path-type","caller-callsite","opencollective-postinstall","prr","lodash._objecttypes","eslint-plugin-prettier","postcss-media-minmax","lodash.get","tinycolor2","eth-ens-namehash","postcss-image-set-function","gkt","win-fork","math-interval-parser","eventsource","rc-table","es6-templates","absolute-path","destroy","split-string","bcrypt","d3-contour","pngquant-bin","knex","buffer","lodash.isequal","karma-jasmine","create-ecdh","highlight.js","react-tap-event-plugin","array-series","bs-snippet-injector","shelljs","bluebird","bootstrap-sass","readline-utils","forever","generate-object-property","autoprefixer","vue-hot-reload-api","async-limiter","cosmiconfig","phin","h2x-generate","read-chunk","archy","netmask","stringify-entities","sumchecker","railroad-diagrams","ylru","custom-event","amd-name-resolver","babel-traverse","@firebase","chrome-trace-event","bytebuffer","webpack-dev-server","xml","zrender","import-from","mixin-deep","ext-list","h2x-traverse","shimmer","asn1","gulp","only","babel-plugin-emotion","lodash.set","css-declaration-sorter","js-cookie","escape-latex","babel-plugin-module-resolver","postcss-modules-extract-imports","header-case","tiny-lr","core-js","spdx-license-ids","nconf","eslint-config-standard-jsx","invariant","ssf","isarray","syntax-error","deprecate","postcss-normalize-charset","randomstring","run-async","fbjs-css-vars","proto-list","find-index","through","async-disk-cache","normalize-selector","canonical-path","buffer-equal","browser-stdout","hoek","callsites","socket.io","stream-shift","color-name","frameguard","whatwg-fetch","flow-bin","metro-react-native-babel-preset","axobject-query","jss-camel-case","jpeg-js","object.entries","pump","ambi","prepend-http","range-parser","vizion","replacestream","is-primitive","dottie","postcss-ordered-values","broccoli-debug","babel-plugin-transform-async-to-generator","strip-dirs","state-toggle","clipboardy","request-promise-native","vue","fs-tree-diff","postcss-scss","decompress-tarbz2","babel-plugin-transform-react-jsx-self","d3-timer","json-loader","pixelmatch","es6-map","es6-shim","babel-plugin-transform-decorators-legacy","ltgt","selenium-webdriver","babel-plugin-syntax-class-constructor-call","color","schema-utils","to-absolute-glob","nodegit","readline-ui","strip-bom-buf","wrappy","csextends","antd","jsdom","p-map-series","indefinite-observable","align-text","file-saver","acorn-dynamic-import","jss-global","write-stream","deasync","unpipe","arrify","encodeurl","enable","content-disposition","css-vendor","constantinople","enquire.js","cliui","i18n","bonjour","semver-diff","p-is-promise","object-is","websocket-extensions","jest-diff","lodash","npm-run-all","random-bytes","babel-plugin-transform-es2015-sticky-regex","nomnom","@sinonjs","core-util-is","duplexer","array-differ","forever-agent","postcss-minify-font-values","lazystream","to-through","taffydb","read-only-stream","jsx-ast-utils","commander","cls-bluebird","google-p12-pem","utila","object.assign","utile","lodash.padend","helmet","keygrip","jss-props-sort","jest-watcher","sugar-core","redux-logger","string-length","npm-bundled","randomatic","events","es-abstract","noble","escodegen","postcss-discard-overridden","vue-loader","archive-type","utf8","redis-errors","lodash.foreach","is-url","decompress","director","tar-stream","widest-line","toidentifier","aws-sdk","protobufjs","tarn","xpath.js","html-tags","ansi-blue","cache-content-type","postcss-jsx","babel-jest","adler-32","tar.gz","postcss-pseudo-class-any-link","postcss-focus-visible","pac-proxy-agent","get-func-name","googleapis-common","string.prototype.trim","log-driver","babel-plugin-syntax-dynamic-import","when","node-rest-client","path-dirname","normalize-package-data","@gulp-sourcemaps","jshint","unicode","babel-plugin-syntax-object-rest-spread","touch","styled-components","defaults","pouchdb","d3-geo","sqlite3","twit","blob","postcss-normalize-whitespace","dotenv","postgres-bytea","babel","server-destroy","kareem","buffer-alloc-unsafe","psl","read","swig","@ant-design","dns-prefetch-control","chainsaw","get-stream","moo","scheduler","write-file-atomic","amp","stylelint-config-standard","fs-updater","babel-plugin-transform-react-jsx","semver-regex","get-port","btoa","xmldoc","co-body","path-root-regex","extsprintf","os-homedir","enhanced-resolve","semver","gulp-match","configstore","execa","swarm-js","yauzl","mime-db","hpack.js","fast-safe-stringify","vinyl-bufferstream","upper-case","postcss-overflow-shorthand","confusing-browser-globals","vasync","elegant-spinner","postcss-lab-function","matcher-collection","fork-ts-checker-webpack-plugin-alt","flush-write-stream","redis","is-boolean-object","xmlbuilder","utf-8-validate","exit","rev-path","strip-eof","babel-plugin-transform-es2015-typeof-symbol","is-typedarray","pad-component","requireindex","transformers","ansi-italic","asap","co-prompt","tv4","hsl-regex","react-native-vector-icons","javascript-natural-sort","create-hash","moment-timezone","dicer","split-ca","postcss-convert-values","bs-logger","rollup-plugin-commonjs","sanitize-filename","vfile-location","babel-plugin-check-es2015-constants","ignorefs","uid-safe","content-type","object-component","isomorphic-fetch","postcss-styled","tree-sync","blessed","rgb-regex","cached-path-relative","winston-transport","lodash._reunescapedhtml","run-queue","resolve-pathname","stringstream","component-emitter","denque","workbox-google-analytics","ts-node","import-local","component-indexof","no-case","is-builtin-module","postcss-color-rebeccapurple","home-or-tmp","jest-each","web3-eth-personal","gaze","function-bind","kind-of","lodash.toarray","leaflet","csv-stringify","ansi-bgred","gulp-clean","immutability-helper","metro-source-map","level","with","log4js","hash-sum","cross-env","istanbul-lib-coverage","has-symbol-support-x","colorspace","cssnano-preset-default","@nodelib","react-side-effect","object.map","flatstr","lodash._reinterpolate","lodash.debounce","expect","is-regex","broccoli-plugin","ssri","pretty-format","archiver-utils","copy-paste","eslint-plugin-es","prompt-question","imagemin","statuses","outpipe","tedious","istanbul","pidusage","jest-resolve","string.prototype.padend","stdout-stream","webpack-stream","h2x-types","jpegtran-bin","babel-helper-builder-binary-assignment-operator-visitor","is-alphanumerical","xmlhttprequest-ssl","next-tick","babylon","css-tree","lodash.some","secure-keys","babel-plugin-istanbul","is-negated-glob","ansi","worker-farm","kleur","truncate-utf8-bytes","json-buffer","find-root","diffie-hellman","finalhandler","ansi-bgcyan","fs-promise","rollup-plugin-babel","@webcomponents","watchpack","postcss-minify-params","pug-filters","gulp-concat","validator","ts-jest","get-value","husky","redux","original","buffer-alloc","koalas","babel-plugin-transform-es2015-unicode-regex","lodash.union","object.omit","p-finally","ajv","vue-router","grunt-contrib-watch","dot-prop","hogan.js","cssom","postcss-loader","timsort","es6-weak-map","lodash.isarguments","eslint-import-resolver-node","color-string","is-date-object","babel-helper-builder-react-jsx","crc-32","zmq","node-watch","immutable","sequencify","utils-merge","rc-trigger","json-schema-traverse","cipher-base","has-value","dateformat","rc","ansi-strikethrough","min-document","util","hubot","passport-local","napi-build-utils","progress-stream","proxy-addr","serialport","hooker","npmlog","whatwg-mimetype","parse-filepath","string-convert","react-transform-hmr","eslint-rule-composer","pullstream","cssstyle","babel-plugin-import","sane","web3-eth-contract","require-uncached","browserify-sign","dom-converter","anymatch","cookies","dom-storage","eslint-config-react-app","jest-docblock","wrap-ansi","keccak","any-shell-escape","eslint-plugin-jsx-a11y","sigmund","negotiator","run-node","docker-modem","winston-daily-rotate-file","undeclared-identifiers","d3-interpolate","omggif","doctypes","rc-editor-mention","dom-serializer","bitcoinjs-lib","prebuild-install","gulp-rev","gh-got","async-listener","connect-history-api-fallback","to-array","loose-envify","tslib","amp-message","terraformer","bplist-parser","remove-trailing-separator","isemail","camelize","node-abi","agent-base","firebase","double-ended-queue","react-dropzone","cryptiles","base64-arraybuffer","expect-ct","postcss-selector-parser","babel-plugin-transform-es2015-template-literals","rc-progress","wcwidth","os-tmpdir","gulp-uglify","object.pick","base","handle-thing","dns-equal","options","get-uri","number-is-nan","array-uniq","crypto-browserify","loader-fs-cache","json5","get-stdin","send","webpack-dev-middleware","cli-boxes","rc-time-picker","drbg.js","select","react-intl","executable","wordwrapjs","lodash.mergewith","express-unless","nodemailer","hide-powered-by","info-symbol","dom-urls","archiver","update-notifier","eslint-config-airbnb-base","babel-helpers","h2x-core","flat","triple-beam","oboe","big-integer","swap-case","clean-up-path","find-versions","web3-providers-ws","slice-ansi","shell-quote","web3-core-method","void-elements","any-promise","check-error","eslint-loader","ramda","fastclick","just-extend","merge-trees","micromatch","watchr","kuler","del","morgan","jest-validate","twilio","dargs","web3-providers-ipc","prompt","propprop","character-entities","multimatch","afinn-165","iota-array","p-timeout","zip-stream","sharp","figlet","ember-rfc176-data","toggle-array","yeast","hpkp","acorn-walk","timers-ext","cline","validate-npm-package-name","csv","css","gcp-metadata","detect-indent","is-npm","fs","orchestrator","homedir-polyfill","abstract-leveldown","dependency-graph","babel-preset-es2017","babel-preset-es2016","babel-helper-explode-assignable-expression","jszip","websocket-driver","eslint-plugin-babel","rc-switch","builtin-modules","jest-environment-node","create-emotion","merge-descriptors","argparse","github","wrench","to-fast-properties","xdg-basedir","handlebars","jest-pnp-resolver","json-parse-better-errors","stylus","deep-metrics","react-app-polyfill","latest-version","buffer-fill","jsonwebtoken","broadway","rc-rate","phantomjs","fined","passport-strategy","xml-name-validator","defer-to-connect","ansi-colors","pend","istanbul-lib-hook","jasmine-core","typeforce","stream-each","eslint-plugin-node","find-my-way","yn","graphql-tools","icss-replace-symbols","babel-helper-get-function-arity","exec-buffer","isnumeric","renderkid","es6-error","slice-stream","fs-mkdirp-stream","nugget","x-is-string","jss-default-unit","metro-config","read-pkg-up","caseless","oauth-sign","co-fs-extra","unique-string","cli-color","repeating","esrecurse","unquote","stylelint-config-recommended","contains-path","pirates","object-inspect","pointer-symbol","rc-tabs","dir-glob","connect","mime-types","object-copy","httpreq","child_process","buffers","ftp","workbox-strategies","into-stream","postcss-image-set-polyfill","xhr-request-promise","append-transform","read-cache","etag","listr-update-renderer","inquirer","damerau-levenshtein","webpack-cli","d3-dsv","metro-babel7-plugin-react-transform","inert","quick-format-unescaped","pug","gulp-sourcemaps","fileset","promise-polyfill","decompress-response","espree","ansi-styles","cookie","acorn","is-natural-number","is-posix-bracket","ansi-bgblue","is-callable","deep-is","universalify","recast","sylvester","react-error-overlay","body-parser","prop-types","fraction.js","babel-preset-jest","css-color-names","define-properties","encoding","unicode-match-property-value-ecmascript","proxy-agent","superagent","flaverr","string-width","ansi-bggreen","unique-stream","postcss-color-hwb","speedometer","unist-util-find-all-after","metalsmith","crypto-js","simple-concat","level-packager","is-string","koa","on-headers","unicode-canonical-property-names-ecmascript","vxx","dom-serialize","mock-fs","lowdb","source-map","logalot","ignorepatterns","rgb-hex","ncp","set-blocking","harmony-reflect","needle","find-babel-config","immediate","unicode-match-property-ecmascript","node-addon-api","bower","from2","path-exists","babel-plugin-syntax-class-properties","jquery","sonic-boom","supports-color","env-variable","in-publish","sha.js","is-plain-object","babel-plugin-transform-es2015-modules-amd","loader-runner","onecolor","request-progress","postcss-custom-properties","exit-hook","level-iterator-stream","lodash._reescape","wbuf","jest-jasmine2","download","pug-strip-comments","strip-bom-string","scrypt","findup-sync","eslint-plugin-standard","nanomatch","is-upper-case","is-color-stop","utility","array-unique","time-stamp","lpad-align","pinkie","prompt-base","registry-url","extend-shallow","extract-zip","lodash.uniq","rc-tooltip","babel-plugin-syntax-exponentiation-operator","hosted-git-info","bowser","log-symbols","setimmediate","sntp","browser-sync-ui","is-glob","array-parallel","postcss-load-config","http-parser-js","portfinder","react","minimalistic-assert","uri-path","ps-tree","charm","term-size","jss","email-addresses","detect-libc","xml-parse-from-string","js-base64","broccoli-source","node-sass","gulp-sass","tiny-secp256k1","eslint-plugin-promise","buffer-writer","sentence-case","buffer-indexof","gulp-typescript","is-nan","js-beautify","tr46","xcode","cheerio","babel-plugin-transform-es2015-destructuring","test-value","identity-obj-proxy","flat-cache","immer","punycode","optipng-bin","postinstall-build","nssocket","bfj","ansi-bgwhite","inflection","rc-editor-core","d3-scale-chromatic","enzyme","hash-base","bcrypt-pbkdf","lodash.last","is-extglob","referrer-policy","digest-header","html-encoding-sniffer","glogg","gulp-load-plugins","ewma","express","rootpath","mamacro","image-size","os-filter-obj","longest","web3-core-helpers","validate-npm-package-license","d3-collection","css-to-react-native","resolve","ansi-black","merge2","bytes","resolve-dir","choices-separator","crc","catharsis","append-field","memory-cache","pug-parser","babel-plugin-transform-es2015-object-super","is-valid-glob","memory-pager","@pm2","art","big-number","ip-regex","jade","mongoose","imagemin-optipng","merge-stream","ecc-jsbn","rc-select","timers-browserify","grunt-contrib-concat","to-regex-range","walk-sync","pm2","is-path-in-cwd","yosay","gulp-eslint","keypress","nopt","dot-case","array-filter","lodash._htmlescapes","convert-source-map","extract-opts","postcss-discard-empty","quick-lru","babel-preset-latest","babel-helper-call-delegate","typedarray","react-virtualized","es6-set","logform","require-dir","babel-plugin-add-module-exports","postcss-color-functional-notation","clone-regexp","node-fetch","jest-runner","shallow-copy","sisteransi","scoped-regex","deprecated-decorator","retry-axios","ansi-regex","github-from-package","postcss-selector-not","d3-selection","mdast-util-compact","gulp-if","keccakjs","home-path","decompress-tar","postcss-color-gray","html-loader","rollup-plugin-node-resolve","node-releases","raf","markdown","rc-drawer","http-errors","http-server","cli-spinner","globals","xtend","koa-bodyparser","pm2-axon","caniuse-lite","lodash.map","connect-multiparty","gulp-watch","pg","any-observable","babel-helper-remap-async-to-generator","@uirouter","pn","intl-format-cache","react-dev-utils","is-my-json-valid","react-helmet","react-lazy-load","babel-plugin-syntax-decorators","object-hash","web3-eth-accounts","basic-auth","rst-selector-parser","npm-conf","react-onclickoutside","browser-split","coveralls","error-symbol","batch","webpack-log","sprintf-js","connect-flash","lodash.template","error","streamfilter","graceful-readlink","pumpify","request-promise-core","eslint-config-standard","babel-plugin-transform-class-properties","ensure-posix-path","normalize-range","p-reduce","is-stream","array-slice","lodash.throttle","open","fibers","babel-plugin-transform-function-bind","pretty-hrtime","expand-brackets","to-camel-case","debug-log","iterall","fbjs","workbox-navigation-preload","react-timer-mixin","colornames","uc.micro","is-expression","browserify-cipher","babel-plugin-transform-es2015-for-of","d3-polygon","keyv","@polymer","should-type","strip-bom-stream","moment","imagemin-gifsicle","download-git-repo","pug-walk","js-yaml","workbox-precaching","grunt-known-options","sha3","sha1","irregular-plurals","faye-websocket","ansi-hidden","mobx","inflation","chartjs-color","js-stringify","assert-plus","ammo","coffee-script","glob-parent","is-windows","ansi-reset","gray-matter","regenerate-unicode-properties","on-finished","lodash.difference","global-modules-path","angular-sanitize","duplexify","ajv-errors","indexof","bitsyntax","foreachasync","nedb","rgb","parents","mockjs","degenerator","parse-bmfont-binary","babel-plugin-jest-hoist","postcss-color-mod-function","ansi-html","lodash.isplainobject","metro-core","svgo","lodash.findindex","emojis-list","dom-closest","mini-css-extract-plugin","d","array.prototype.flat","broccoli-kitchen-sink-helpers","jsonify","lcov-parse","ignore","flux","capture-exit","bser","is-fullwidth-code-point","call-me-maybe","pkg-config","base64id","methods","istanbul-lib-source-maps","simple-plist","require_optional","command-exists","left-pad","bounce","acorn-globals","has-color","intl-messageformat-parser","dont-sniff-mimetype","eth-lib","babel-generator","retry","openurl","unicode-property-aliases-ecmascript","console-control-strings","lodash._isnative","hsts","unset-value","lodash._reevaluate","slash","right-align","shallow-clone","bin-check","relateurl","rc-animate","log-utils","bl","babel-plugin-transform-exponentiation-operator","wrap-fn","step","nearley","is-generator-fn","css-stringify","popper.js","keycode","react-dnd","querystringify","whatwg-url","chart.js","postcss-apply","estree-walker","esquery","stacktrace-parser","engine.io","subarg","gulp-filter","front-matter","string_decoder","intl","codepage","default-user-agent","fast-glob","web3-core","gh-pages","lodash._escapestringchar","lodash.isobject","pkginfo","json-stable-stringify-without-jsonify","ts-helpers","module-deps","hapi","gulp-mocha","gulp-jshint","json2mq","null-check","markdown-escapes","webpack-sources","errno","pg-types","long","columnify","is-scoped","vendors","bigi","stylis","eslint-config-airbnb","d3-force","systemjs","method-override","object-path","xpath","fast-ordered-set","compressible","append-buffer","@jimp","bip66","read-pkg","fork-stream","webpack-node-externals","atob","create-react-context","path-to-regexp","deep-extend","reduce-css-calc","mini-store","caller","emitter-listener","aes-js","modify-filename","element-ui","prompt-choices","set-getter","defined","chai","log-update","raw-loader","expand-tilde","warning","web3-shh","workbox-streams","iferr","browser-resolve","workbox-background-sync","phantom","dom-align","amqp","concat-with-sourcemaps","postcss-custom-selectors","crypt","postcss-syntax","nan","value-or-function","csv-parse","ansi-align","xmldom","metro-resolver","h2x-parse","postcss-attribute-case-insensitive","babel-extract-comments","babel-helper-vue-jsx-merge-props","rc-form","mongodb","backbone","parse5","readline2","minipass","throttle-debounce","command-line-usage","emoji-regex","last-call-webpack-plugin","eslint-utils","randomfill","lead","smart-buffer","object.defaults","fill-range","lodash.tail","array-back","karma","is-path-cwd","walker","fresh","thunky","once","browserslist","loglevelnext","agentkeepalive","jimp","scoped-http-client","string-template","cli-table","is-alphabetical","math-random","websocket-stream","generate-function","x-is-array","eslint-module-utils","library.min.js","v8flags","rc-tree","yamljs","jstransformer","decamelize-keys","pnp-webpack-plugin","camelcase-keys","stable","ripemd160","loud-rejection","browser-pack","unzip","xml2js","imagemin-svgo","resolve-from","valid-url","process-nextick-args","multicast-dns-service-types","seed-random","for-each","electron","express-jwt","trough","underscore","mout","vlq","code-point-at","postgres-date","symbol-tree","forever-monitor","bufferstreams","ansi-bold","fast-diff","which-pm-runs","rc-hammerjs","postcss-minify-selectors","level-codec","grunt-legacy-log-utils","standard-engine","global-prefix","cfb","is-function","http-basic","cron","cache-base","rc-collapse","winston","mktemp","lolex","is-symbol","git-clone","apparatus","vinyl-fs","decompress-unzip","postgres-array","prompts","clipboard","find-replace","express-session","hsla-regex","mitt","binary-search-tree","body","babel-plugin-transform-object-rest-spread","thenify-all","isexe","gulp-changed","gm","axios","normalize-path","pause-stream","extglob","encoding-down","cyclist","remark","cookie-signature","text-hex","metro","utf8-byte-length","recursive-readdir","pkg-conf","lodash.groupby","virtual-dom","JSONStream","is-root","rx-lite","reflect-metadata","should-equal","wif","babel-helper-replace-supers","cross-spawn","combine-lists","is-relative","babel-plugin-transform-es2015-arrow-functions","gulp-plumber","utif","array-union","postcss-initial","nth-check","bindings","feature-policy","iconv-lite","use","from","broccoli-funnel","jest-leak-detector","jest-resolve-dependencies","source-list-map","recompose","capture-stack-trace","nock","node-dir","bufferutil","ultron","ascli","gulp-util","adm-zip","node-cache","mdn-data","bin-version","nano-json-stream-parser","MD5","circular-json","react-scripts","karma-chrome-launcher","metro-babel-register","humanize-url","merkle-lib","json-stable-stringify","istanbul-api","strip-json-comments","tar","process","postcss-unique-selectors","eslint-restricted-globals","pbkdf2","unique-filename","create-error-class","stream-counter","koa-static","mixin-object","ipaddr.js","memoize-one","should-util","inversify","cookie-parser","googleapis","cli-spinners","fs-constants","generic-pool","is-hexadecimal","toml","pretty-bytes","user-home","npm","klaw","postcss-normalize-unicode","fast-deep-equal","frac","lodash.padstart","error-inject","serialize-javascript","help-me","decamelize","babel-plugin-transform-regenerator","output-file-sync","stream-consume","lodash.values","delayed-stream","loglevel","caniuse-api","passport-facebook","node-cmd","glob-stream","vue-resource","default-require-extensions","sw-toolbox","wordwrap","eslint","regenerator-runtime","snapdragon-util","binaryextensions","babel-plugin-named-asset-import","mustache","webidl-conversions","jshint-stylish","object.values","react-native","postcss-value-parser","lodash.clone","strip-color","bin-wrapper","mem-fs-editor","type-detect","pull-stream","gulp-rename","throttleit","snapdragon","has-unicode","static-module","async-each-series","asynckit","chain-function","express-handlebars","web3-eth-abi","util.promisify","find-cache-dir","mqtt","posix-character-classes","tough-cookie","attr-accept","babel-preset-react","rsvp","bignumber.js","shallow-equal","fs-exists-sync","estree-is-function","apollo-utilities","stream-buffers","seq-queue","strict-uri-encode","d3-ease","babel-helper-bindify-decorators","http-proxy","hammerjs","is-generator-function","babel-plugin-transform-es2015-block-scoping","postcss-custom-media","simple-get","react-prop-types","workbox-range-requests","merge","slide","react-devtools-core","tracer","lie","babel-runtime","seek-bzip","har-schema","reduce-reducers","querystring","inline-source-map","clone-buffer","postcss-pseudoelements","istanbul-reports","jest-serializer","minimatch","run-parallel","vinyl-file","async-validator","buffer-from","ret","rc-dropdown","css-animation","yargs","clone","localforage","to-readable-stream","babel-plugin-transform-es2015-modules-umd","react-icons","delegates","promptly","intersperse","data-uri-to-buffer","fs-access","zen-observable","p-queue","figgy-pudding","unescape","passthrough-counter","bech32","lodash.restparam","multipipe","clone-response","postcss-media-query-parser","isstream","safer-buffer","elasticsearch","lodash._basecopy","resumer","dashdash","babel-plugin-transform-class-constructor-call","parse-entities","postcss-message-helpers","prop-types-extra","@xtuc","get-proxy","d3-voronoi","traverse","sinon-chai","semver-truncate","nullthrows","through2-filter","braces","toposort","hawk","pinkie-promise","domain-browser","pegjs","strip-url-auth","binary-extensions","simple-assign","is-promise","babel-plugin-dynamic-import-node","postcss-resolve-nested-selector","htmlparser2","mpath","listr","jest-get-type","findit","discord.js","gulp-conflict","rc-upload","has-cors","stream-combiner2","whatwg-encoding","currently-unhandled","has-binary2","des.js","exec-sh","individual","chardet","terraformer-wkt-parser","object-keys","ignore-walk","copy-to","copy-webpack-plugin","promise-map-series","union-value","nanoid","file-loader","signal-exit","is-data-descriptor","require-all","mobx-react","level-write-stream","throat","optionator","pify","ember-cli-version-checker","safe-json-stringify","node-expat","unique-slug","@webassemblyjs","fbjs-scripts","combine-source-map","stream-browserify","postcss-reduce-transforms","shebang-command","lodash.sortby","util-deprecate","retry-as-promised","browserify-aes","which","web3-eth-ens","vuvuzela","postcss-normalize-display-values","soap","de-indent","normalize.css","web3-eth","co-read","character-entities-legacy","engine.io-parser","function-source","array-find-index","propagate","parse-headers","xhr-request","text-table","assign-symbols","d3-scale","array-tree-filter","performance-now","unist-util-stringify-position","url","redis-parser","request","crypto-random-string","react-dom","exif-parser","continuable-cache","diagnostics","responselike","prompt-list","style-search","socket.io-parser","tryer","servify","multer","y18n","postcss-color-hsl","jquery-ui","jest-matcher-utils","css-select","is-equal-shallow","vm-browserify","optjs","dns-packet","end-stream","pause","uid2","jest-util","backo2","fecha","restler","babel-plugin-syntax-flow","should","entities","lodash.isfunction","mimic-response","tape","to-object-path","lodash._getnative","bplist-creator","beeper","title-case","parse-glob","argv-tools","unherit","levelup","stylis-rule-sheet","broccoli-babel-transpiler","domhandler","postcss-values-parser","qs","preact","hash-for-dep","get-own-enumerable-property-symbols","cssnano-util-same-parent","gulp-postcss","undefsafe","heimdalljs","nise","radio-symbol","is-resolvable","token-stream","denodeify","serialize-error","postcss-font-family-system-ui","babel-helper-hoist-variables","babel-plugin-transform-decorators","grunt-legacy-util","postcss-discard-duplicates","webpack-manifest-plugin","keymirror","minimalistic-crypto-utils","bcrypt-nodejs","sugarss","base-64","babel-plugin-transform-react-jsx-source","vinyl-sourcemap","tapable","gulp-notify","fast-json-parse","nightmare","pug-code-gen","event-target-shim","simple-swizzle","query-string","fs-copy-file-sync","progress","babel-plugin-transform-object-assign","postcss-normalize-timing-functions","astral-regex","babel-plugin-transform-es2015-block-scoped-functions","deferred-leveldown","type-check","revalidator","content-security-policy-builder","onetime","eazy-logger","byline","jsdoc","react-hot-loader","typed-function","kew","joi","aws-sign2","node-forge","cron-parser","redux-actions","evp_bytestokey","rollup-pluginutils","babel-loader","tempfile","stylus-loader","figures","symlink-or-copy","ee-first","node-static","ws","highland","srcset","eslint-plugin-import","babel-preset-stage-2","babel-preset-stage-3","babel-preset-stage-0","babel-preset-stage-1","co","error-stack-parser","walk","babel-preset-env","d3-random","table","jsonpointer","babel-plugin-styled-components","indexes-of","weak-map","make-plural","os-name","css-parse","postcss-selector-matches","split2","minimist","yaml","rc-cascader","fastparse","fs-minipass","http-assert","postcss-modules-scope","mutationobserver-shim","path-is-absolute","makeerror","xlsx","es6-promise","decimal.js","babel-plugin-syntax-async-functions","assert","deglob","humanize-ms","rgba-regex","ansi-red","angular-animate","remark-parse","corser","acorn-jsx","randexp","exit-on-epipe","material-ui","parse-json","json-stringify-safe","vinyl-source-stream","chalk","repeat-element","lodash.isstring","ant-design-palettes","requirejs","unique-random","inherits","source-map-url","express-validator","lodash.isboolean","babel-eslint","redux-form","postcss-cssnext","vinyl-sourcemaps-apply","is-wsl","react-proxy","babel-plugin-transform-runtime","path-key","wkx","aws4","babel-plugin-transform-do-expressions","redux-saga","selfsigned","tunnel-agent","workbox-cache-expiration","object.getownpropertydescriptors","grpc","unbzip2-stream","eslint-scope","brfs","component-inherit","has-to-string-tag-x","http","tslint-react","html-comment-regex","detect-node","postcss-calc","readdirp","imagemin-jpegtran","deep-diff","codemirror","value-equal","stream-transform","i","colour","lodash._basetostring","is-subset","http-cache-semantics","tiny-emitter","babel-plugin-transform-es2015-spread","minizlib","babel-plugin-transform-react-remove-prop-types","create-hmac","abab","sync-rpc","ansi-escapes","toposort-class","url-set-query","less","strip-indent","gulp-less","gulp-babel","grunt-contrib-copy","arr-diff","map-obj","bip32","csso","iftype","icss-utils","strip-hex-prefix","serviceworker-cache-polyfill","data-urls","lodash.flatten","node-int64","saxes","extendr","file-stream-rotator","is-obj","d3-color","raven","please-upgrade-node","css-loader","collection-visit","charenc","node-localstorage","@sailshq","koa-is-json","babel-helper-regex","knox","babel-code-frame","unist-util-remove-position","web3-core-subscriptions","tslint","babel-plugin-macros","install","osenv","longest-streak","sourcemap-codec","class-utils","make-dir","editorconfig","require-directory","global-modules","semver-store","async","trim-repeated","debug-fabulous","postcss-modules-local-by-default","temp-dir","test-exclude","twitter","redis-commands","babel-plugin-transform-strict-mode","postcss-logical","node-schedule","resolve-url","true-case-path","hyperquest","tmp","unist-util-is","tsutils","react-is","cssnano-util-get-match","pascal-case","strip-comments","html-webpack-plugin","shortid","deepmerge","buffer-shims","md5-file","callback-stream","globjoin","estraverse","lower-case","vuex","slug","babel-plugin-syntax-do-expressions","labeled-stream-splicer","insert-module-globals","is-descriptor","snekfetch","regenerate","fd-slicer","react-overlays","number-to-bn","grunt-legacy-log","reduce-flatten","static-eval","get-caller-file","timed-out","vue-style-loader","trim-right","upper-case-first","css-selector-tokenizer","normalize-wheel","socks","stack-utils","promise","browser-process-hrtime","nodegit-promise","bson","buffer-to-arraybuffer","is-buffer","date-now","mississippi","yaeti","ev-store","scrypt-js","viewport-dimensions","grunt-contrib-uglify","is-dotfile","lodash._root","just-curry-it","ndarray","require-from-string","echarts","uncontrollable","progress-bar-webpack-plugin","pkg-dir","jest-snapshot","base-x","lodash.partialright","is-accessor-descriptor","sshpk","lodash.escaperegexp","yeoman-generator","glob-to-regexp","postcss-discard-comments","oauth","rxjs-compat","flatmap-stream","he","to-space-case","temp","sw-precache","sync-request","postcss-merge-longhand","semver-compare","brace-expansion","uglifyjs-webpack-plugin","sass-graph","ext-name","es6-iterator","timespan","domino","arraybuffer.slice","amdefine","glob-base","postcss-sass","simple-git","ini","babel-plugin-transform-es2015-classes","lodash.includes","is-word-character","dom-scroll-into-view","config-chain","clean-webpack-plugin","pseudomap","p-defer","boom","babel-core","workbox-sw","rc-notification","stream-splicer","lodash.pad","less-loader","ecstatic","metro-memory-fs","promirepl","detect-file","canvas","varuint-bitcoin","chance","taketalk","babel-plugin-ember-modules-api-polyfill","rimraf","squeak","readline","ethjs-util","esprima","karma-phantomjs-launcher","cliff","socket.io-client","node-libs-browser","istanbul-lib-report","i18next","node.extend","dnd-core","builtin-status-codes","file-type","array-map","is-absolute","is-redirect"]);var Co=S(require("events"));var Ht={OPEN:"OPEN",ERROR:"ERROR",CLOSE:"CLOSE"};var _t=class{constructor(e,t,r){this.context=e,this.scriptStore=t,this.v8InspectorApi=r}getId(){return this.context.getProbe().id}getV8InspectorApi(){return this.v8InspectorApi}getV8BreakpointId(){return this.context.getV8BreakpointId()}getProbe(){return this.context.getProbe()}getLocationId(){return this.context.getLocationId()}getClient(){return this.context.getProbe().client}getContext(){return this.context}enable(){this.context.getProbe().enabled=!0}disable(){this.context.getProbe().enabled=!1}isDisabled(){return this.context.getProbe().enabled==!1}isExpired(){return this.context.isExpired()}updateProbe(e){let t=this.context.getProbe();t.tracingEnabled=e.tracingEnabled,e.condition?t.condition=e.condition:t.condition&&(t.condition=null),e.expireSecs&&(t.expireSecs=e.expireSecs),e.expireCount&&(t.expireCount=e.expireCount),e.enabled!=null&&(t.enabled=e.enabled)}},_=class{constructor(e){this.action=e}getId(){return this.action.getId()}getV8InspectorApi(){return this.action.getV8InspectorApi()}getV8BreakpointId(){return this.action.getV8BreakpointId()}getLocationId(){return this.action.getLocationId()}getProbe(){return this.action.getProbe()}updateProbe(e){this.action.updateProbe(e)}getType(){return this.action.getType()}getClient(){return this.action.getClient()}getContext(){return this.action.getContext()}enable(){return this.action.enable()}disable(){return this.action.disable()}isDisabled(){return this.action.isDisabled()}isExpired(){return this.action.isExpired()}onProbe(e){this.action.onProbe(e)}};var Le=class extends _{constructor(t){super(t);this.v8InspectorApi=t.getV8InspectorApi()}onProbe(t){if(!this.checkCondition(t.params.callFrames[0])){n.debug("<ConditionAwareProbeAction> Condition did not valid.");return}super.onProbe(t)}checkCondition(t){let r=this.getContext(),o=!0;if(r!=null){let s=r.getCondition();if(s)try{let c=this.v8InspectorApi.evaluateOnCallFrame({callFrameId:t.callFrameId,expression:s,returnByValue:!0,throwOnSideEffect:!0});c&&c.response&&c.response.result&&c.response.result.subtype!=="error"&&c.response.result.value==!1&&(o=!1)}catch{n.debug("<ConditionAwareProbeAction> An error occured while evaluating condtion."),o=!1}}return o}};var Mr=class{};var Te=class extends Mr{},bo=["AttachRequest"],Ne=class extends Te{constructor(t,r){super();this.type="Request",this.name=this.constructor.name,this.id=t,this.client=r}setName(t){this.name=t}},Ut=class extends Ne{constructor(t,r,o){super(r,o);this.setName("FilterTracePointsRequest"),this.applicationFilter=t}},$t=class extends Ne{constructor(t,r,o){super(r,o);this.setName("FilterLogPointsRequest"),this.applicationFilter=t}},Vt=class extends Ne{constructor(e,t){super(e,t),this.setName("GetConfigRequest")}},C=class extends Te{constructor(t,r,o){super();this.requestId=r,this.name=t,this.client=o,this.type="Response",this.source="Agent",this.runtime=`NodeJS-${process.version}`,this.agentVersion="",this.erroneous=!1,this.errorCode=0}setError(t){this.erroneous=!0,this.errorCode=t instanceof $?t.code:0,this.errorMessage=t.message}};var zt=class extends C{constructor(e,t){super("PutTracePointResponse",e,t)}},Gt=class extends C{constructor(e,t){super("UpdateTracePointResponse",e,t)}},Wt=class extends C{constructor(e,t){super("RemoveTracePointResponse",e,t)}},Xt=class extends C{constructor(t,r){super("RemoveBatchTracePointResponse",t,r);this.removedTracePointIds=[],this.unRemovedTracePointIds={}}},Qt=class extends C{constructor(e,t){super("EnableTracePointResponse",e,t)}},Kt=class extends C{constructor(e,t){super("DisableTracePointResponse",e,t)}};var Yt=class extends C{constructor(e,t){super("PutLogPointResponse",e,t)}},Jt=class extends C{constructor(e,t){super("UpdateLogPointResponse",e,t)}},Zt=class extends C{constructor(e,t){super("RemoveLogPointResponse",e,t)}},er=class extends C{constructor(t,r){super("RemoveBatchLogPointResponse",t,r);this.removedLogPointIds=[],this.unRemovedLogPointIds={}}},tr=class extends C{constructor(e,t){super("EnableLogPointResponse",e,t)}},rr=class extends C{constructor(e,t){super("DisableLogPointResponse",e,t)}},or=class extends C{constructor(e,t){super("EnableProbeTagResponse",e,t)}},ir=class extends C{constructor(e,t){super("DisableProbeTagResponse",e,t)}},sr=class extends C{constructor(e,t){super("RemoveProbeTagResponse",e,t)}};var nr=class extends C{constructor(e,t){super("UpdateConfigResponse",e,t)}},ar=class extends C{constructor(e,t){super("AttachResponse",e,t)}},cr=class extends C{constructor(e,t){super("DetachResponse",e,t)}},ee=class extends Te{constructor(t,r=!1,o,s){super();this.id=o||y.generateId(),this.name=t,this.sendAck=r,this.client=s,this.type="Event"}},lr=class extends ee{constructor(t,r,o,s,c,l,d,g=!1,x,f,k){super(t,g,y.generateId(),r);this.fileName=o,this.className=l,this.lineNo=d,this.methodName=s,this.frames=c,this.traceId=x,this.transactionId=f,this.spanId=k}},pr=class extends lr{constructor(t,r,o,s,c,l,d,g=!1,x,f,k){super("TracePointSnapshotEvent",r,o,s,c,l,d,g,x,f,k);this.tracePointId=t}},ur=class extends ee{constructor(t,r,o,s,c=!1){super("TracePointSnapshotFailedEvent",c,t,r);this.className=o,this.lineNo=s,this.errorCode=0,this.errorMessage=""}setError(t){this.errorCode=t instanceof $?t.code:0,this.errorMessage=t.message}},mr=class extends lr{constructor(t,r,o,s,c,l,d,g=!1,x,f,k){super("ErrorStackSnapshotEvent",void 0,r,o,c,l,d,g,x,f,k);this.errorStackId=t,this.error=s}},dr=class extends ee{constructor(t,r,o,s=!1){super("ApplicationStatusEvent",s,t,o);this.application=r}},gr=class extends ee{constructor(t,r,o,s,c,l,d,g,x=!1){super("LogPointEvent",x,y.generateId(),r);this.logPointId=t,this.fileName=o,this.className=c,this.lineNo=l,this.methodName=s,this.logMessage=d,this.createdAt=g}},fr=class extends ee{constructor(t,r,o,s,c=!1){super("LogPointFailedEvent",c,t,r);this.className=o,this.lineNo=s,this.errorCode=0,this.errorMessage=""}setError(t){this.errorCode=t instanceof $?t.code:0,this.errorMessage=t.message}},br=class extends ee{constructor(t,r,o,s,c=!1){super("ProbeRateLimitEvent",c,t,s);this.className=r,this.lineNo=o}};var Dr=class{constructor(){this.store=new Map,this.index=0}add(){return this.index++,this.store.set(this.index,{}),this.index}get(e){return this.store.get(e)}delete(e){this.store.delete(e)}clear(){this.store.clear()}},ho="(...arguments) => global.__atlas_copy(arguments)";process.__atlas_backchannel=new Dr;global.__atlas_copy=function([e,t,...r]){let o=process.__atlas_backchannel.get(e);o.this=t,o.scopes=r};var te=class{constructor(e,t,r){this.probeId=t.id,this.v8BreakpointId=e,this.rawProbe=t,this.locationId=m.generateLocationId(t),this.generatedPosition=r,this.createdAt=new Date().getTime(),this.hitCount=0,this.rawProbe.expireSecs&&(this.expiredAt=this.createdAt+this.rawProbe.expireSecs*1e3),this.expirable=!0}getV8BreakpointId(){return this.v8BreakpointId}getLocationId(){return this.locationId}getClient(){return this.rawProbe.client}getLineNo(){return this.generatedPosition?this.generatedPosition.line:this.rawProbe.lineNo}getFileName(){return this.generatedPosition?this.generatedPosition.path:this.rawProbe.fileName}getHitCount(){return this.hitCount}hit(){this.hitCount++}isExpired(){let e=!1;return this.expirable&&(this.rawProbe.expireCount&&(e=this.hitCount>this.rawProbe.expireCount),!e&&this.expiredAt&&(e=new Date().getTime()>=this.expiredAt)),e}getGeneratedPosition(){return this.generatedPosition}getCondition(){return this.rawProbe.condition}getProbe(){return this.rawProbe}getTags(){return this.rawProbe.tags}};var Me=new Map,De=class{static formatValue(e,t){if(t===void 0)return"";switch(e){case"number":case"boolean":return t;default:return String(t)}}static shouldFramePathBeResolved(e){if(Me.has(e))return Me.get(e);let t=!0;return A.isPathInCurrentWorkingDirectory(e)||(t=!1),t&&A.isPathInNodeModulesDirectory(A.resolveRelativePath(e))&&(t=!1),Me.size>1e4&&Me.clear(),Me.set(e,t),t}};var mi={["ENUMERABLE-OWN"]:i=>Object.keys(i||{}),["ENUMERABLE-OWN-AND-ENUMERABLE-PARENT"]:i=>{let e=new Set;for(let t in i)e.add(t);return Array.from(e)},["ENUMERABLE-OWN-AND-NON-ENUMERABLE-OWN"]:i=>Object.getOwnPropertyNames(i||{}),["ENUMERABLE-OWN-AND-NON-ENUMERABLE-OWN-ENUMERABLE-PARENT"]:i=>{let e=new Set;for(let t in i)e.add(t);return Object.getOwnPropertyNames(i||{}).forEach(t=>e.add(t)),Array.from(e)}},Fe=class{static getProperties(e,t="ENUMERABLE-OWN"){return e?mi[t](e):[]}};var je=class{convert(e=[]){let t=[];return e.forEach(r=>{let{lineNo:o,methodName:s,className:c,locals:l}=r,d={lineNo:o,methodName:s,className:c,variables:{}};if(t.push(d),l){let g=this.findResolvedVariable(l,{maxProperties:u.get(a.capture.maxProperties),maxParseDepth:u.get(a.capture.maxParseDepth)});g&&!Array.isArray(g)&&(d.variables=g)}}),t}findResolvedVariable(e,t,r=1){let o=c=>{let l=c.slice(0,t.maxProperties),d=[],g=l.length;for(let x=0;x<g;x++){let f=l[x],k=!u.get(a.sourceCode.minified)&&f&&f.constructor&&f.constructor.name||typeof f;if(H.isObject(f))if(Object.getOwnPropertyNames(f).length==0)try{f=f+""}catch(ie){n.debug(`<CaptureFrameConverter> An error occured while parsing 
                with type ${k}: ${ie.message}`),f=""}else f=r>t.maxParseDepth?"...":this.findResolvedVariable(f,t,r+1);let b=Array.isArray(f);d.push({"@type":b?"array":k,"@value":f,...b?{"@array":!0}:void 0})}return d},s=c=>{let l={},d=Fe.getProperties(c,u.get(a.capture.propertyAccessClassification)),g=Math.min(d.length,t.maxProperties);for(let x=0;x<g;x++){let f=d[x],k=f,b=c[f],ie=!u.get(a.sourceCode.minified)&&b&&b.constructor&&b.constructor.name||typeof b;if(!l[k]){if(H.isObject(b))if(Object.getOwnPropertyNames(b).length==0)try{b=b+""}catch(Fo){n.debug(`<CaptureFrameConverter> An error occured while parsing 
                  field ${k} with type ${ie}: ${Fo.message}`),b=""}else b=r>t.maxParseDepth?"...":this.findResolvedVariable(b,t,r+1);let Hr=Array.isArray(b);l[k]={"@type":Hr?"array":ie,"@value":b,...Hr?{"@array":!0}:void 0}}}return l};return Array.isArray(e)?o(e):s(e)}};var Fr=class{constructor(e,t,r){this.v8InspectorApi=e,this.frame=t,this.captureConfig=r}capture(){let e=process.__atlas_backchannel.add();try{let t=process.__atlas_backchannel.get(e),r=this.frame.scopeChain,o=[{value:e}];o.push({objectId:this.frame.this.objectId});for(let c=0;c<r.length;c++){let l=r[c],d=r[c+1];(l.type==="local"||l.type==="catch"||l.type==="block"||l.type==="closure"&&(d===void 0||d.type!=="global"))&&o.push({objectId:l.object.objectId})}let s=null;if(this.v8InspectorApi.post("Runtime.callFunctionOn",{objectId:r[0].object.objectId,functionDeclaration:ho,arguments:o,objectGroup:"backtrace"},c=>{s=c}),s!==null)throw s;this.scopes=t.scopes,this.this=t.this,this.this===global&&(this.this=void 0)}finally{process.__atlas_backchannel.delete(e)}}get(){let e={};for(let t=0;t<(this.scopes||[]).length;t++){let r=this.scopes[t],o=Object.keys(r);for(let s=0;s<o.length&&!(s+1>this.captureConfig.maxProperties);s++){let c=o[s];e[c]||(e[c]=r[c])}}return e}},z=class extends _t{constructor(t,r,o){super(t,r,o);this.captureFrameConverter=new je,this.captureFrameDataReductionCallback=u.get(a.dataReduction.captureFrame)}prepareFrames(t){let r=t;if(this.captureFrameDataReductionCallback)try{r=this.captureFrameDataReductionCallback(t)}catch(o){n.debug(`<CaptureProbeAction> An error occured when calling captureFrameDataReductionCallback ${o.message}`)}return r}resolveFrames(t){let r=[],o=Math.min(t.length,u.get(a.capture.maxFrames));for(let s=0;s<o;s++){let c=t[s],l=this.resolveFullPath(c);De.shouldFramePathBeResolved(l)&&r.push(this.resolveFrame(c,s<u.get(a.capture.maxExpandFrames)))}return r}resolveFrame(t,r){let o={};if(r){let l=new Fr(this.v8InspectorApi,t,this.getCaptureConfig());l.capture(),o=l.get()}let s=this.resolveLocation(t),c=this.resolveFunctionName(t);return{capturedTime:new Date().toISOString(),className:s.path||"",lineNo:s.line,methodName:c||"",locals:o}}resolveFunctionName(t){return t?t.functionName===""?"(anonymous function)":t.functionName:""}resolveLocation(t){let r,o=A.getRoutePath(t.url.replace("file://","")),s=this.scriptStore.getByScriptUrl(o)||this.scriptStore.get(t.location.scriptId);return s&&s.sourceFileInfoMap&&([r]=s.sourceFileInfoMap.values()),{path:r?r.rootPath:s?s.rawFileRelativePath:"",line:t.location.lineNumber}}resolveFullPath(t){let r=t.location.scriptId;return this.scriptStore&&this.scriptStore.getScriptRawFilePath(r)||""}getCaptureConfig(){return{maxFrames:u.get(a.capture.maxFrames,10),maxExpandFrames:u.get(a.capture.maxExpandFrames,1),maxProperties:u.get(a.capture.maxProperties,10),maxParseDepth:u.get(a.capture.maxParseDepth,3),propertyAccessClassification:u.get(a.capture.propertyAccessClassification,"ENUMERABLE-OWN"),minified:u.get(a.sourceCode.minified,!1)}}};var w=class{Application(){}static getApplicationInfoProvider(){return w.applicationInfoProvider}static setApplicationInfoProvider(e){w.applicationInfoProvider=e}static getApplicationInfo(){if(!!w.applicationInfoProvider)return w.applicationInfoProvider.getApplicationInfo()}};var R=class{static createTracepointFilterRequest(){let e=w.getApplicationInfo();if(!!e)return new Ut({name:e.applicationName,stage:e.applicationStage,version:e.applicationVersion,customTags:e.applicationTags},y.generateId())}static createLogpointFilterRequest(){let e=w.getApplicationInfo();if(!!e)return new $t({name:e.applicationName,stage:e.applicationStage,version:e.applicationVersion,customTags:e.applicationTags},y.generateId())}static createGetConfigRequest(){if(!!w.getApplicationInfo())return new Vt(y.generateId())}static appendResponseProperties(e){let t=e;if(t){let r=w.getApplicationInfo();r&&(t.applicationName||(t.applicationName=r.applicationName),t.applicationInstanceId||(t.applicationInstanceId=r.applicationInstanceId))}}static appendEventProperties(e){let t=e;if(t){t.id||(t.id=y.generateId()),t.time||(t.time=new Date().getTime());let r=w.getApplicationInfo();r&&(t.hostName||(t.hostName=r.hostname),t.applicationName||(t.applicationName=r.applicationName),t.applicationInstanceId||(t.applicationInstanceId=r.applicationInstanceId))}}};var p=class{constructor(){}static setCommunicationApi(e){p.comminicationApi=e}static setProviderList(e){p.applicationStatusProviderList=e}static send(e){p.comminicationApi&&(n.debug("<CommunicationManager> Sending data to communication api."),p.comminicationApi.send(e))}static sendRequest(e){p.send(e)}static sendResponse(e){R.appendResponseProperties(e),p.send(e)}static sendEvent(e){R.appendEventProperties(e),p.send(e)}static sendApplicationStatusEvent(e){let t=w.getApplicationInfo(),r={name:t.applicationName,hostName:t.hostname,instanceId:t.applicationInstanceId,runtime:t.applicationRuntime,stage:t.applicationStage,customTags:t.applicationTags?Object.keys(t.applicationTags).map(o=>({tagName:o,tagValue:t.applicationTags[o]})):[],version:t.applicationVersion};p.applicationStatusProviderList.forEach(o=>{o.provide(r,e)}),p.sendEvent(new dr(y.generateId(),r,e))}};var hr=class{constructor(){this.resolve()}};var yr,xr=class extends hr{resolve(){try{this.state!=="NOTRESOLVED"&&(yr=require(xr.OTEL_LIB),this.state="RESOLVED",n.debug("<OpenTelemetryTraceInfoResolver> @opentelemetry/api resolved."))}catch{this.state=this.state==null?"INITIATED":"NOTRESOLVED",n.debug("<OpenTelemetryTraceInfoResolver> @opentelemetry/api did not resolved.")}}get(){try{if(this.state==="NOTRESOLVED")return;if(this.state==="INITIATED")if(require.resolve(xr.OTEL_LIB))this.resolve();else{this.state="NOTRESOLVED";return}if(this.state==="RESOLVED"){let e=yr.trace;if(e&&yr.context.active){let t=e.getSpan(yr.context.active());if(t&&t.spanContext)return{traceId:t.spanContext().traceId,spanId:t.spanContext().spanId,transactionId:t.spanContext().traceId}}}}catch(e){n.debug(`<OpenTelemetryTraceInfoResolver> An error occured while obtaining opentelemetry trace info. ${e.message}`)}}},fe=xr;fe.OTEL_LIB="@opentelemetry/api";var di={OpenTelemetry:new fe},yo,gi=()=>{for(let i of Object.values(di)){let e=i.get();if(e){n.debug("<TraceInfoSupport> Trace info loaded."),yo=e;break}}},xo=()=>yo;global.__atlas_loadTraceInfo=()=>(gi(),!0);var Be=class extends z{constructor(e,t,r){super(e,t,r)}getType(){return"Tracepoint"}onProbe(e){n.debug("<TracePointAction> Tracepoint probe action working ...");try{this.handleTracepoint(this.resolveFrames(e.params.callFrames),this.context.getProbe().tracingEnabled?xo():void 0)}catch(t){n.debug(`<TracePointAction> An error occured while resolving frames ${t.message}`),this.sendTracepointFailedEvent(t)}}handleTracepoint(e,t){setImmediate(()=>{try{let r=this.prepareFrames(e);if(!r)return;let o=this.captureFrameConverter.convert(r),s=new pr(this.context.rawProbe.id.replace(`${this.context.rawProbe.type}:`,""),this.context.rawProbe.client,this.context.rawProbe.remoteFilename||this.context.rawProbe.fileName,o&&o[0]?o[0].methodName:"",o,this.context.rawProbe.fileName,this.context.rawProbe.lineNo);t&&Object.assign(s,t),p.sendEvent(s)}catch(r){n.debug(`<TracePointAction> An error occured while resolving frames ${r.message}`),this.sendTracepointFailedEvent(r)}})}sendTracepointFailedEvent(e){setImmediate(()=>{try{let t=new ur(y.generateId(),this.context.rawProbe.client,this.context.rawProbe.remoteFilename||this.context.rawProbe.fileName,this.context.rawProbe.lineNo),r=m.getCodedError(e,this.context.rawProbe);t.setError(r||e),p.sendEvent(t)}catch(t){n.debug(`<TracePointAction> An error occured while sending tracepoint snapshot failed event ${t.message}`)}})}};var qe=class extends te{constructor(e,t,r){super(e,t,r)}getProbeAction(){return"Tracepoint"}};var Oe=class extends _{constructor(e){super(e)}isExpired(){return this.getContext().isExpired()}onProbe(e){if(this.isExpired()){n.debug("<ExpiringProbeAction> Probe expired.");return}super.onProbe(e)}};var He=class extends _{constructor(t,r){super(t);this.rateLimiter=r}onProbe(t){if(this.checkRateLimited()){n.debug("<RateLimitedProbeAction> Rate limit exceeded.");return}super.onProbe(t)}checkRateLimited(){let t=this.rateLimiter.checkRateLimit(new Date().getTime());if(t==="HIT"){n.debug("<RateLimitedProbeAction> Rate limit hitted.");let r=this.getContext();r&&p.sendEvent(new br(y.generateId(),r.getFileName(),r.getLineNo(),r.getClient()))}return t==="EXCEEDED"}};var bi=require("mustache"),_e=class{static render(e,t){return bi.render(e,t)}};var Ue=class extends z{constructor(t,r,o){super(t,r,o);this.logMessageDataReductionCallback=u.get(a.dataReduction.logMessage)}onProbe(t){n.debug("<LogPointAction> Logpoint probe action working ...");let r;try{r=this.resolveFrames(t.params.callFrames)}catch(c){n.debug(`<LogPointAction> An error occured while resolving frames ${c.message}`),this.sendLogpointFailedEvent(c);return}let{logLevel:o,stdoutEnabled:s}=this.context.getProbe();if(s&&o)try{let c=this.prepareFrames(r);if(c.length,!c||!c.length)return;let l=c[0],d=this.prepareLogMessage(l);if(!d)return;this.writeLogMessageToConsole(d,l.capturedTime),setImmediate(()=>{this.sendLogpointEvent(l,d)})}catch(c){n.debug(`<LogPointAction> An error occured while preparing log message ${c.message}`),this.sendLogpointFailedEvent(c)}else setImmediate(()=>{try{let c=this.prepareFrames(r);if(!c)return;let l=c[0],d=this.prepareLogMessage(l);if(!d)return;this.sendLogpointEvent(l,d)}catch(c){n.debug(`<LogPointAction> An error occured while preparing log message ${c.message}`),this.sendLogpointFailedEvent(c)}})}updateProbe(t){let r=this.context.getProbe();t.logExpression&&(r.logExpression=t.logExpression),t.logLevel&&(r.logLevel=t.logLevel),t.stdoutEnabled!=null&&(r.stdoutEnabled=t.stdoutEnabled),super.updateProbe(t)}getType(){return"Logpoint"}sendLogpointEvent(t,r){try{let{id:o,client:s,fileName:c,lineNo:l,remoteFilename:d}=this.context.getProbe(),g=new gr(o.replace(`${this.context.rawProbe.type}:`,""),s,d||c,t.methodName,c,l,r,t.capturedTime);p.sendEvent(g)}catch(o){this.sendLogpointFailedEvent(o)}}sendLogpointFailedEvent(t){setImmediate(()=>{try{let r=new fr(y.generateId(),this.context.rawProbe.client,this.context.rawProbe.remoteFilename||this.context.rawProbe.fileName,this.context.rawProbe.lineNo),o=m.getCodedError(t,this.context.rawProbe);r.setError(o||t),p.sendEvent(r)}catch(r){n.debug(`<LogPointAction> An error occured while sending log point failed event ${r.message}`)}})}prepareLogMessage(t){let{logExpression:r}=this.context.getProbe();if(!r)return;let{locals:o}=t,s=_e.render(r,o);return this.logMessageDataReductionCallback&&(s=this.logMessageDataReductionCallback({fileName:this.context.getFileName(),lineNo:this.context.getLineNo(),logExpression:r,logMessage:s,methodName:t.methodName},o)),s}writeLogMessageToConsole(t,r=new Date().toISOString()){let{logLevel:o,stdoutEnabled:s}=this.context.getProbe();s&&o&&t&&process.stdout.write(`
 ${r} [${o.toLocaleUpperCase()}] ${t} 
`)}getCaptureConfig(){return{...super.getCaptureConfig(),maxFrames:1}}};var $e=class extends te{constructor(e,t,r){super(e,t,r)}getProbeAction(){return"Logpoint"}};var Ve=class extends z{constructor(t,r,o){super(t,r,o);this.captureFrame=u.get(a.errorCollection.captureFrame)}getType(){return"ErrorStack"}onProbe(t){n.debug("<ErrorStackAction> Error stack probe action working ...");try{this.handleErrorStack(t,this.captureFrame?this.resolveFrames(t.params.callFrames):void 0)}catch(r){n.debug(`<ErrorStackAction> An error occured while resolving frames ${r.message}`)}}handleErrorStack(t,r){setImmediate(()=>{try{let o,s,c,l,{params:d}=t,g=d.callFrames[0],x=new Date().toISOString();if(r){let b=this.prepareFrames(r);if(!b)return;l=this.captureFrameConverter.convert(b),{className:o,lineNo:s,methodName:c}=l[0]}else({path:o,line:s}=this.resolveLocation(g)),c=this.resolveFunctionName(g);let f={};if(d.data){let b=d.data;b&&(f.name=b.className,f.stack=b.description,f.stack&&(f.message=f.stack.substring(0,f.stack.indexOf(`
`))))}let k=new mr(`${o}:${s}:${x}`,o,c,f,l,o,s);p.sendEvent(k)}catch(o){n.debug(`<ErrorStackAction> An error occured while handling error stack ${o.message}`)}})}};var ze=class extends te{constructor(e,t){super(e,t)}getProbeAction(){return"ErrorStack"}};var re=class{constructor(e=200){this.milisecondsInMinute=1e3*60;this.window=4;this.rateLimitInfos=[];this.inMinute=e,this.idxMask=this.window-1}checkRateLimit(e){let t=Math.floor(e/this.milisecondsInMinute),r=t&this.idxMask,o=this.rateLimitInfos[r];if(!o)o=this.setRateLimitInfo(r,null,t);else if(o.minute<t)o=this.setRateLimitInfo(r,o,t);else if(o.minute>t)return"OK";if(!o)return"OK";o.increaseCounter();let s=o.counter;return s<this.inMinute?"OK":s==this.inMinute?"HIT":"EXCEEDED"}setRateLimitInfo(e,t,r){let o=new jr(r);if(!t)this.rateLimitInfos[e]=o;else if(t==this.rateLimitInfos[e])this.rateLimitInfos[e]=o;else return this.rateLimitInfos[e];return o}},jr=class{constructor(e){this.minute=e,this.counter=0}increaseCounter(){this.counter=this.counter+1}};var vo=S(require("lru-cache")),Ge=class extends _{constructor(t,r){super(t);this.rateLimiterLruCache=new vo.default({max:100,maxSize:100,ttl:1e3*60*5,allowStale:!1,updateAgeOnGet:!0,updateAgeOnHas:!0,sizeCalculation:(o,s)=>1}),this.inMinute=r||u.get(a.errorCollection.rateLimit.pointInMinute)}onProbe(t){if(this.checkRateLimited(t)){n.debug("<ErrorRateLimitedProbeAction> Rate limit exceeded.");return}super.onProbe(t)}checkRateLimited(t){let r=t.params.callFrames[0],o=`${r.location.scriptId}:${r.location.lineNumber}`,s=this.rateLimiterLruCache.get(o);return s||(s=new re(this.inMinute),this.rateLimiterLruCache.set(o,s)),s.checkRateLimit(new Date().getTime())==="EXCEEDED"}};var hi={ConditionAwareProbeAction:i=>new Le(i),RateLimitedProbeAction:i=>new He(i,new re(u.get(a.rateLimit.inMinute))),ErrorRateLimitedProbeAction:i=>new Ge(i),ExpiringProbeAction:i=>new Oe(i)},be=class{static getAction(e,t,r){let o;switch(e.probe.type){case"Tracepoint":o=new Be(new qe(e.v8BreakpointId,e.probe,e.generatedPosition),t,r);break;case"Logpoint":o=new Ue(new $e(e.v8BreakpointId,e.probe,e.generatedPosition),t,r);break;case"ErrorStack":o=new Ve(new ze(e.v8BreakpointId,e.probe),t,r);break;default:return}return e.probe.actions.forEach(s=>{let c=hi[s];c&&(o=c(o))}),o}};var Ao=S(require("fs"));var Eo=require("child_process"),oe=class{static isFileTypescript(e){return A.getFileExtention(e)===".ts"}static statSync(e){return Ao.statSync(e)}static getActiveGitRepositoryName(){try{return(0,Eo.execSync)("git remote get-url origin").toString().trim().split("/").pop().replace(/\.git$/,"")}catch{return null}}};var he=class{static validateVersion(e,t=0,r=0){let[o,s,c]=process.version.substr(1).split("."),l=parseInt(o),d=parseInt(s),g=parseInt(c);return l>e||l===e&&(d>t||d===t&&g>=r)}};var Ar={...Ht,MESSAGE:"MESSAGE"},vr=class extends Co.default{constructor(t,r){super();this.numBreakpointHitsBeforeReset=0;this.connected=!1;this.probeStore=t||new se,this.scriptStore=r||new Re,this.paused=!1,this.fillConfig()}connect(t){this.tryConnect(t),this.activateErrorCollection()}reconnect(){this.close(!0),this.connect(!0)}close(t){if(this.connected=!1,this.session)try{this.deactivateErrorCollection(),this.clearCleanupAsyncCallStackIntervalRef(),this.clearAllBreakpoints(!t),this.session.post("Debugger.setBreakpointsActive",{active:!1}),this.session.post("Debugger.disable"),this.session.post("Debugger.resume")}finally{this.session.disconnect(),this.session=null}}get(t){let r=this.probeStore.get(t);return r&&r.getContext()?r.getContext().getProbe():void 0}getAll(){return this.probeStore.getAllProbes()}getByLocationId(t){return this.probeStore.getProbeIdsByLocationId(t)}getByTag(t){return this.probeStore.getProbeByTag(t)}removeTag(t){this.probeStore.removeProbeTag(t)}add(t){let r=A.canonizeFileName(t.fileName),o=this.scriptStore.getByScriptUrl(r);if(!o)throw new Pe(`Script did not find with name ${r}`);let s=o.findSourceFileInfo(r);if(!s)throw new Pe(`Script did not find with name ${r}`);if(this.probeStore.get(t.id))throw new Q(`Probe with id ${t.id} already exist.`);if(this.hashCheckEnable&&!oe.isFileTypescript(r)&&t.fileHash&&!o.isCompatableWithFile(t.fileHash))throw new J;m.validateCondition(t);let c,l=this.scriptStore.generatedPositionFor(r,t.lineNo);if(this.probeStore.isV8BreakpointExistOnLocation(t))c=this.probeStore.findV8Breakpoint(t),n.debug(`<DefaultDebugApi> Existing V8breakpoint will updated ${JSON.stringify(c)} for new probe ${t.id}`);else{let g=this.v8InspectorApi.setBreakpointByUrl({lineNumber:(l?l.line:t.lineNo)-1,url:`${s.rawPath}`,...t.tracingEnabled?{condition:"global.__atlas_loadTraceInfo()"}:void 0});if(g.error||!g.response)throw new N(g.error.message);c=g.response.breakpointId,n.debug(`<DefaultDebugApi> V8Breakpoint stored ${c}`)}let d=be.getAction({v8BreakpointId:c,probe:t,generatedPosition:l},this.scriptStore,this.v8InspectorApi);if(!d)throw new N("<DefaultDebugApi> Probe did not put.");this.probeStore.set(c,d)}update(t){let r=this.probeStore.get(t.id);if(!r)throw new M;if(r.getClient()!==t.client)throw new D;n.debug(`<DefaultDebugApi> Probe will updated ${t.id}`);let o=r.getProbe();if(o.tracingEnabled!==t.tracingEnabled){let s=this.scriptStore.getByScriptUrl(o.fileName);if(!s){n.debug(`<DefaultDebugApi> Script did not find with name ${o.fileName}`);return}let c=s.findSourceFileInfo(o.fileName);if(!c){n.debug(`<DefaultDebugApi> Script did not find with name ${o.fileName}`);return}let l=r.getContext().getGeneratedPosition();this.v8InspectorApi.updateBreakpointByUrl(r.getV8BreakpointId(),{lineNumber:(l?l.line:t.lineNo)-1,url:`${c.rawPath}`,...t.tracingEnabled?{condition:"global.__atlas_loadTraceInfo()"}:void 0})}m.validateCondition(t),r.updateProbe(t)}delete(t){let r=this.probeStore.get(t.id);if(!r)throw new M;if(r.getClient()!==t.client)throw new D;n.debug(`<DefaultDebugApi> Probe will deleted ${t.id}`);let o=r.getId(),s=r.getV8BreakpointId();this.probeStore.delete(o),this.probeStore.isV8BreakpointExist(s)||this.deleteV8Breakpoint(s)}enable(t){let r=this.probeStore.get(t.id);if(!r)throw new M;if(r.getClient()!==t.client)throw new D;n.debug(`<DefaultDebugApi> Probe will enabled ${t.id}`),r.enable()}disable(t){let r=this.probeStore.get(t.id);if(!r)throw new M;if(r.getClient()!==t.client)throw new D;n.debug(`<DefaultDebugApi> Probe will disabled ${t.id}`),r.disable()}enableErrorCollect(){!u.get(a.errorCollection.enable)||!this.errorCollectionInitiated||!this.session||(this.appendErrorProbe(),this.session.post("Debugger.setPauseOnExceptions",{state:"all"}),n.debug("<DefaultDebugApi> Error collection enabled."))}disableErrorCollect(){!this.session||(this.session.post("Debugger.setPauseOnExceptions",{state:"none"}),this.probeStore.delete(F),n.debug("<DefaultDebugApi> Error collection disabled."))}activateErrorCollection(){!u.get(a.errorCollection.enable)||(this.errorCollectionInitiated=!0,this.enableErrorCollect(),this.errorStackRateLimiter||(this.errorStackRateLimiter=new re(u.get(a.errorCollection.rateLimit.totalInMinute))),n.debug("<DefaultDebugApi> Error collection initiated."))}deactivateErrorCollection(){this.errorCollectionInitiated=!1,this.errorStackRateLimiter=null,this.disableErrorCollect()}fillConfig(){this.enableAsyncCallStack=u.get(a.debugApi.enableAsyncCallStack),this.cleanupAsyncCallStackInterval=u.get(a.debugApi.cleanupAsyncCallStackInterval),this.resetV8Debugger=u.get(a.debugApi.resetV8Debugger),this.resetV8DebuggerThreshold=u.get(a.debugApi.resetV8DebuggerThreshold),this.hashCheckEnable=u.get(a.scriptStore.hashCheckEnable),this.cleanEveryXCalls=this.resetV8DebuggerThreshold}appendErrorProbe(){this.probeStore.get(F)&&this.probeStore.delete(F),this.probeStore.set(F,be.getAction({probe:{id:F,type:"ErrorStack",actions:["ErrorRateLimitedProbeAction"]}},this.scriptStore,this.v8InspectorApi))}tryConnect(t){n.debug("<DefaultDebugApi> Connecting to inspector session."),this.session=new Po.Session,this.session.connect(),t&&this.v8InspectorApi?this.v8InspectorApi.setSession(this.session):this.v8InspectorApi=new jt(this.session),this.session.on("Debugger.scriptParsed",r=>{t||this.scriptLoaded(r)}),this.session.on("Debugger.scriptFailedToParse",({params:r})=>{this.paused||this.session===null||this.cleanDebuggerMemory()}),this.session.on("Debugger.paused",r=>{if(!r||!r.params){n.debug("<DefaultDebugApi> V8Breakpoint paused event cannot be empty.");return}try{this.paused=!0,r.params.reason==="exception"||r.params.reason==="promiseRejection"?this.handleErrorDebugPausedEvent(r):this.handleUserDebugPausedEvent(r)}finally{this.paused=!1,this.cleanPausesMemory(),this.resetV8Debugger&&this.tryResetV8Debugger()}}),he.validateVersion(12,9)?this.session.post("Debugger.enable",{maxScriptsCacheSize:2}):this.session.post("Debugger.enable"),this.session.post("Debugger.setBreakpointsActive",{active:!0}),this.enableAsyncCallStack&&(this.session.post("Debugger.setAsyncCallStackDepth",{maxDepth:1}),he.validateVersion(14)&&(this.cleanupAsyncCallStackIntervalRef=setInterval(()=>{try{this.session.post("Debugger.setAsyncCallStackDepth",{maxDepth:0}),this.session.post("Debugger.setAsyncCallStackDepth",{maxDepth:1})}catch(r){n.debug(`<DefaultDebugApi> An error occured while cleanupAsyncCallStack error: ${r}`)}},this.cleanupAsyncCallStackIntervalRef).unref())),this.connected=!0,t||this._emit(Ar.OPEN,this.session)}clearAllBreakpoints(t=!1){let r=this.probeStore.getAllProbeContexts();if(r)for(let o of r){let s=o.getProbe().id;try{let c=o.getV8BreakpointId;this.session.post("Debugger.removeBreakpoint",{breakpointId:c},l=>{n.debug(`<DefaultDebugApi> An error occured while clear breakpoint ${l.message}`)})}finally{t&&this.probeStore.delete(s)}}}clearCleanupAsyncCallStackIntervalRef(){this.cleanupAsyncCallStackIntervalRef&&(clearInterval(this.cleanupAsyncCallStackIntervalRef),this.cleanupAsyncCallStackIntervalRef=null)}cleanPausesMemory(){this.pausesToClean+=1,this.pausesToClean>this.cleanEveryXCalls&&this.session&&(setImmediate(()=>{try{this.session.post("Debugger.resume")}catch{}}),this.pausesToClean=0)}cleanDebuggerMemory(){this.callsToClean+=1,this.callsToClean>this.cleanEveryXCalls&&!this.paused&&this.session&&(this.session.post("Runtime.releaseObjectGroup",{objectGroup:"backtrace"}),this.callsToClean=0)}tryResetV8Debugger(){try{if(this.numBreakpointHitsBeforeReset+=1,this.numBreakpointHitsBeforeReset<this.resetV8DebuggerThreshold)return;n.debug("<DefaultDebugApi> Try to reset inspector session."),this.numBreakpointHitsBeforeReset=0;let t=this.probeStore.getAllProbeContexts();if(this.reconnect(),t)for(let r of t){let o=r.getProbe(),s=this.scriptStore.getByScriptUrl(o.fileName);if(!s){n.debug(`<DefaultDebugApi> Script did not find with name ${o.fileName}`);return}let c=s.findSourceFileInfo(o.fileName);if(!c){n.debug(`<DefaultDebugApi> Script did not find with name ${o.fileName}`);return}let l=r.getGeneratedPosition();this.v8InspectorApi&&this.v8InspectorApi.setBreakpointByUrl({lineNumber:(l?l.line:o.lineNo)-1,url:`${c.rawPath}`,...o.tracingEnabled?{condition:"global.__atlas_loadTraceInfo()"}:void 0})}}catch(t){n.debug(`<DefaultDebugApi> An error occured while trying to reset session. ${t.message}`)}}deleteV8Breakpoint(t){return this.v8InspectorApi?!this.v8InspectorApi.removeBreakpoint(t).error:null}scriptLoaded(t){if(!t||!t.params||!t.params.url||!t.params.scriptId){n.debug("<DefaultDebugApi> Script information can not be empty.");return}let r=t.params.url,o=!1;if((r===""||Ie.isBlackListedModule(r))&&(o=!0),o){n.debug(`<DefaultDebugApi> Script will skipped. ${r}`);return}try{this.v8InspectorApi.post("Debugger.getScriptSource",{scriptId:t.params.scriptId},(s,c)=>{if(s){n.debug(`<DefaultDebugApi> An error occured while get script source. ${r} ${s.message}`);return}try{this.scriptStore.set({scriptParams:t.params,scriptRawUrl:r,scriptSource:c.scriptSource})}catch(l){n.debug(`<DefaultDebugApi> Script did not stored. ${r} ${l.message}`)}})}catch(s){n.debug(`<DefaultDebugApi> An error occured while loading script. ${r} ${s.message}`)}finally{this.cleanDebuggerMemory()}}handleErrorDebugPausedEvent(t){try{let r=this.probeStore.get(F);if(!r){this.disableErrorCollect(),n.debug("<DefaultDebugApi> Error connection probe can not be empty, error collection disabled.");return}if(r.getContext().hit(),this.errorStackRateLimiter.checkRateLimit(new Date().getTime())!=="OK"){this.disableErrorCollect(),n.debug("<DefaultDebugApi> Total error connection rate limit hit, error stack collection disabled.");return}let s=t.params.callFrames[0];if(!s||!s.location||!s.location.scriptId){n.debug("<DefaultDebugApi> Error stack collection frame can not be empty.");return}let c=this.scriptStore.get(s.location.scriptId);if(!c||Kr.some(l=>c.rawFilename.indexOf(l)>-1))return;r.onProbe(t)}catch(r){n.debug(`<DefaultDebugApi> An error occured while handling error stack ${r.message}`)}}handleUserDebugPausedEvent(t){try{let r=t.params;if(!r.hitBreakpoints){n.debug("<DefaultDebugApi> V8Breakpoint paused event params cannot be empty.");return}let o=r.hitBreakpoints[0];if(!o){n.debug("<DefaultDebugApi> V8Breakpoint id cannot be empty.");return}let s=this.probeStore.getProbeIds(o);if(!s){n.debug("<DefaultDebugApi> Probe did not find in store."),this.deleteV8Breakpoint(o);return}for(let c of s){let l=this.probeStore.get(c);try{if(l.getContext().hit(),l.isDisabled()){n.debug(`<DefaultDebugApi> Probe ${l.getId()} disabled.`);continue}if(l.isExpired()){n.debug(`<DefaultDebugApi> Probe ${l.getId()} expired.`),this.delete(l.getProbe());continue}l.onProbe(t)}catch{n.debug(`<DefaultDebugApi> An error occured while handling probe action ${l.getId()}`)}}}catch{n.debug("<DefaultDebugApi> An error occured while handling V8 breakpoint pause event.")}}_emit(t,r){this.connected&&this.emit(t,r)}};var E={...Ht,MESSAGE:"MESSAGE"};var Br=require("ws"),wo=S(require("events"));var U=class extends wo.default{constructor(t,r){super();this.connected=!0;this.address=t,this.options=r}static generateBrokerUrl(t,r){return t.startsWith("ws://")||t.startsWith("wss://")?t+":"+r:"wss://"+t+":"+r}static generateBrokerHeaders(){let t={},r=w.getApplicationInfo();return t[U.API_KEY_HEADER_NAME]=u.get(a.agent.apiKey),t[U.APP_INSTANCE_ID_HEADER_NAME]=r.applicationInstanceId,t[U.APP_NAME_HEADER_NAME]=r.applicationName,t[U.APP_STAGE_HEADER_NAME]=r.applicationStage,t[U.APP_VERSION_HEADER_NAME]=r.applicationVersion,t[U.APP_HOSTNAME_HEADER_NAME]=r.hostname,t[U.APP_RUNTIME_HEADER_NAME]=r.applicationRuntime,r.applicationTags&&Object.keys(r.applicationTags).forEach(o=>{let s=`${U.APP_TAG_HEADER_NAME_PREFIX}${o}`;t[s]||(t[s]=r.applicationTags[o])}),t}connect(){this.tryConnect()}reconnect(){this.tryConnect(!0)}close(){this.connected=!1,this.ws.readyState==1&&(this.ws.close(),this.ws=null)}send(t){return new Promise((r,o)=>{this.ws.readyState==1?this.ws.send(JSON.stringify(t),s=>{if(s)return o(s);r("")}):r("")})}tryConnect(t){this.ws=new Br.WebSocket(`${this.address}/ws/app`,this.options);let o=()=>{this.ws&&this.ws.readyState===Br.WebSocket.OPEN&&(n.debug("<DebugBrokerApi> Sending ping"),this.ws.ping(),setTimeout(o,3e4))};this.ws.once("open",()=>{n.debug("<DebugBrokerApi> Broker connection established"),this.connected=!0,this._emit(E.OPEN,this),o()}),this.ws.on("message",s=>{let c=JSON.parse(s.toString());this._emit(E.MESSAGE,c)}),this.ws.on("error",s=>{this.connected=!0,n.debug(`<DebugBrokerApi> An error occured on broker connection. ${s.message}`),this._emit(E.ERROR,{reload:t,message:s.message})}),this.ws.once("close",(s,c)=>{n.debug(`<DebugBrokerApi> Connection closed with broker. Code: ${s} Reason: ${c}`),this._emit(E.CLOSE,{code:s,reason:c}),this.connected=!1})}_emit(t,r){this.connected&&this.emit(t,r)}},I=U;I.API_KEY_HEADER_NAME="x-atlas-api-key",I.APP_INSTANCE_ID_HEADER_NAME="x-atlas-app-instance-id",I.APP_NAME_HEADER_NAME="x-atlas-app-name",I.APP_STAGE_HEADER_NAME="x-atlas-app-stage",I.APP_VERSION_HEADER_NAME="x-atlas-app-version",I.APP_HOSTNAME_HEADER_NAME="x-atlas-app-hostname",I.APP_RUNTIME_HEADER_NAME="x-atlas-app-runtime",I.APP_TAG_HEADER_NAME_PREFIX="x-atlas-app-tag-";var ko=S(require("events"));var qr=class extends ko.default{},We=class extends qr{constructor(t){super();this.apiStatus=t}},ye=class extends We{constructor(t){super(t);this.onMessage=r=>setImmediate(()=>this._handleMessage(r))}_handleMessage(t){if(u.get(a.agent.silent)&&!bo.includes(t.name)){n.debug(`<MessageHandlerListener> Message name: ${t.name} skipped. Agent on silent mode.`);return}this.handleMessage(t)}};var Xe=class extends We{constructor(t,r){super(r);this.debugApi=t}listen(){return new Promise((t,r)=>{try{n.debug("<DebugApiListener> Trying to listen debug api ...");let o=()=>{n.debug("<DebugApiListener> Debug api listening."),this.apiStatus.setStatus(this.debugApi.constructor.name,!0),t()},s=()=>{n.debug("<DebugApiListener> Comminication api connection closed."),this.apiStatus.setStatus(this.debugApi.constructor.name,!1)};this.debugApi.on(Ar.OPEN,o),this.debugApi.on(Ar.CLOSE,s),this.debugApi.connect()}catch{r()}})}unlisten(){n.debug("<DebugApiListener> Unlisten debug api."),this.debugApi.close()}};var Qe=class extends ye{constructor(t,r,o,s){super(s);this.firstConnection=!0;this.retryConnection=!0;this.errorMessageDisplayed=!1;this.communicationApi=t,this.handlerContainer=r,this.debugApi=o}listen(){return new Promise((t,r)=>{try{n.debug("<CommunicationApiListener> Trying to listen Communication api ...");let o=()=>{this.firstConnection=!1,this.errorMessageDisplayed=!1,this.retryConnection=!0,n.info("<CommunicationApiListener> Communication api listening."),p.setCommunicationApi(this.communicationApi),this.apiStatus.setStatus(this.communicationApi.constructor.name,!0),this.communicationApi.on(E.MESSAGE,this.onMessage),p.sendApplicationStatusEvent(),setTimeout(()=>{p.sendRequest(R.createTracepointFilterRequest()),p.sendRequest(R.createLogpointFilterRequest()),p.sendRequest(R.createGetConfigRequest()),t()},2e3)},s=({message:l})=>{this.errorMessageDisplayed||(n.error(`<CommunicationApiListener> An error occured on socket connection: ${l}`),this.errorMessageDisplayed=!0),this.firstConnection&&l&&l.includes("401")&&(this.retryConnection=!1)},c=()=>{if(n.debug("<CommunicationApiListener> Communication api connection closed."),this.apiStatus.setStatus(this.communicationApi.constructor.name,!1),this.communicationApi.removeListener(E.MESSAGE,this.onMessage),u.get(a.agent.silent)){n.debug("<CommunicationApiListener> Retry process skipped. Agent in silent mode."),this.retryConnection=!1;return}this.retryConnection?setTimeout(()=>{n.debug("<CommunicationApiListener> Try to reconnect communication api."),this.communicationApi.reconnect()},3e3):this.firstConnection&&r("Connection did not established with broker.")};this.communicationApi.on(E.OPEN,o),this.communicationApi.on(E.ERROR,s),this.communicationApi.on(E.CLOSE,c),this.communicationApi.connect()}catch{n.error("<CommunicationApiListener> An error occured while to listen communication api."),r()}})}unlisten(){n.debug("<CommunicationApiListener> Unlisten communication api."),this.communicationApi.removeListener(E.MESSAGE,this.onMessage),this.communicationApi.close(),this.apiStatus.setStatus(this.communicationApi.constructor.name,!1)}async handleMessage(t){try{n.debug("<CommunicationApiListener> Handle message.");let r=this.handlerContainer.getHandler(t);if(!r){n.debug("<CommunicationApiListener> Handler not found for message.");return}let o=r.handle(t);o&&(n.debug("<CommunicationApiListener> Response send to communication api."),p.sendResponse(o))}catch{n.error("<CommunicationApiListener> An error occured while handling message.")}}};var ne=class{validateLineNo(e){if(e<=0)throw new Y}validateAndGetFileName(e){if(!e)throw new K;return e}extractFileName(e){return m.extractFileNameFrom(e,"contents")}},xe=class extends ne{constructor(t){super();this.tracepointManager=t}},ve=class extends ne{constructor(t){super();this.logpointManager=t}},Er=class extends ne{constructor(t){super();this.tagManager=t}},Ae=class extends ne{constructor(t){super();this.configManager=t}};var L=class extends xe{constructor(e){super(e)}};var Ke=class extends L{constructor(e){super(e)}handle(e){n.debug(`<PutTracePointRequestHandler> Handling put tracepoint message. 
            ${e.fileName} ${e.tracePointId}`);let t=new zt(e.id,e.client);try{e.fileName=this.validateAndGetFileName(e.fileName),this.validateLineNo(e.lineNo),this.tracepointManager.putTracepoint({...e,id:e.tracePointId,tracingEnabled:e.enableTracing}),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<PutTracePointRequestHandler> An error occured while handling put tracepoint message. ${r.message}`),t.setError(r)}finally{return t}}};var Ye=class extends L{constructor(e){super(e)}handle(e){n.debug(`<EnableTracePointRequestHandler> Handling enable tracepoint message. ${e.tracePointId}`);let t=new Qt(e.id,e.client);try{this.tracepointManager.enableTracePoint(e.tracePointId,e.client),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<EnableTracePointRequestHandler> An error occured while handling enable message. ${r.message}`),t.setError(r)}finally{return t}}};var Je=class extends L{constructor(e){super(e)}handle(e){n.debug(`<DisableTracePointRequestHandler> Handling disable tracepoint message. ${e.tracePointId}`);let t=new Kt(e.id,e.client);try{this.tracepointManager.disableTracePoint(e.tracePointId,e.client),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<DisableTracePointRequestHandler> An error occured while handling disable message. ${r.message}`),t.setError(r)}finally{return t}}};var Ze=class extends L{constructor(e){super(e)}handle(e){n.debug(`<RemoveTracePointRequestHandler> Handling remove tracepoint message. ${e.tracePointId}`);let t=new Wt(e.id,e.client);try{this.tracepointManager.removeTracePoint(e.tracePointId,e.client),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<RemoveTracePointRequestHandler> An error occured while handling remove message. ${r.message}`),t.setError(r)}finally{return t}}};var et=class extends L{constructor(e){super(e)}handle(e){n.debug("<RemoveBatchTracePointRequestHandler> Handling remove batch tracepoint message");let t=new Xt(e.id,e.client);try{for(let r in e.tracePointIds)try{this.tracepointManager.removeTracePoint(r,e.client),t.removedTracePointIds.push(r)}catch(o){t.unRemovedTracePointIds[r]=o.message}p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<RemoveBatchTracePointRequestHandler> An error occured while handling remove batch message. ${r.message}`)}finally{return t}}};var tt=class extends L{constructor(e){super(e)}handle(e){n.debug(`<UpdateTracePointRequestHandler> Handling update tracepoint message. ${e.tracePointId}`);let t=new Gt(e.id,e.client);try{let r={...e,id:e.tracePointId,tracingEnabled:e.enableTracing};this.tracepointManager.updateTracePoint(r),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<UpdateTracePointRequestHandler> An error occured while handling update message. ${r.message}`),t.setError(r)}finally{return t}}};var T=class extends ve{constructor(e){super(e)}};var rt=class extends T{constructor(e){super(e)}handle(e){n.debug(`<PutLogPointRequestHandler> Handling put logpoint message. 
            ${e.fileName} ${e.logPointId}`);let t=new Yt(e.id,e.client);try{e.fileName=this.validateAndGetFileName(e.fileName),this.validateLineNo(e.lineNo),this.logpointManager.putLogpoint({...e,id:e.logPointId}),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<PutLogPointRequestHandler> An error occured while handling put logpoint message. ${r.message}`),t.setError(r)}finally{return t}}};var ot=class extends T{constructor(e){super(e)}handle(e){n.debug(`<EnableLogPointRequestHandler> Handling enable logpoint message. ${e.logPointId}`);let t=new tr(e.id,e.client);try{this.logpointManager.enableLogPoint(e.logPointId,e.client),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<EnableLogPointRequestHandler> An error occured while handling enable message. ${r.message}`),t.setError(r)}finally{return t}}};var it=class extends T{constructor(e){super(e)}handle(e){n.debug(`<DisableLogPointRequestHandler> Handling disable logpoint message. ${e.logPointId}`);let t=new rr(e.id,e.client);try{this.logpointManager.disableLogPoint(e.logPointId,e.client),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<DisableLogPointRequestHandler> An error occured while handling disable message. ${r.message}`),t.setError(r)}finally{return t}}};var st=class extends T{constructor(e){super(e)}handle(e){n.debug(`<RemoveLogPointRequestHandler> Handling remove logpoint message. ${e.logPointId}`);let t=new Zt(e.id,e.client);try{this.logpointManager.removeLogPoint(e.logPointId,e.client),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<RemoveLogPointRequestHandler> An error occured while handling remove message. ${r.message}`),t.setError(r)}finally{return t}}};var nt=class extends T{constructor(e){super(e)}handle(e){n.debug("<RemoveBatchLogPointRequestHandler> Handling remove batch logpoint message");let t=new er(e.id,e.client);try{for(let r in e.logPointIds)try{this.logpointManager.removeLogPoint(r,e.client),t.removedLogPointIds.push(r)}catch(o){t.unRemovedLogPointIds[r]=o.message}p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<RemoveBatchLogPointRequestHandler> An error occured while handling remove batch message. ${r.message}`)}finally{return t}}};var at=class extends T{constructor(e){super(e)}handle(e){n.debug(`<UpdateLogPointRequestHandler> Handling update logpoint message. ${e.logPointId}`);let t=new Jt(e.id,e.client);try{let r={...e,id:e.logPointId,stdoutEnabled:e.stdoutEnabled};this.logpointManager.updateLogPoint(r),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<UpdateLogPointRequestHandler> An error occured while handling update message. ${r.message}`),t.setError(r)}finally{return t}}};var G=class extends Er{constructor(e){super(e)}};var ct=class extends G{constructor(e){super(e)}handle(e){n.debug(`<EnableProbeTagRequestHandler> Handling enable tag message. 
            ${e.tag}`);let t=new or(e.id,e.client);try{this.tagManager.enableTag(e.tag),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<EnableProbeTagRequestHandler> An error occured while handling enable tag message. ${r.message}`),t.setError(r)}finally{return t}}};var lt=class extends G{constructor(e){super(e)}handle(e){n.debug(`<DisableProbeTagRequestHandler> Handling disable tag message. 
            ${e.tag}`);let t=new ir(e.id,e.client);try{this.tagManager.disableTag(e.tag),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<DisableProbeTagRequestHandler> An error occured while handling disable tag message. ${r.message}`),t.setError(r)}finally{return t}}};var pt=class extends G{constructor(e){super(e)}handle(e){n.debug(`<RemoveProbeTagRequestHandler> Handling Remove tag message. 
            ${e.tag}`);let t=new sr(e.id,e.client);try{this.tagManager.removeTag(e.tag),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<RemoveProbeTagRequestHandler> An error occured while handling Remove tag message. ${r.message}`),t.setError(r)}finally{return t}}};var W=class extends Ae{constructor(e){super(e)}};var ut=class extends W{constructor(e){super(e)}handle(e){n.debug("<UpdateConfigRequestHandler> Handling update config reqeust message.");let t=new nr(e.id,e.client);try{this.configManager.updateConfig(e.config),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<UpdateConfigRequestHandler> An error occured while handling update config reqeust message. ${r.message}`),t.setError(r)}finally{return t}}};var mt=class extends W{constructor(e){super(e)}handle(e){n.debug("<AttachRequestHandler> Handling attach reqeust message.");let t=new ar(e.id,e.client);try{this.configManager.makeUnsilent(),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<AttachRequestHandler> An error occured while handling attach reqeust message. ${r.message}`),t.setError(r)}finally{return t}}};var dt=class extends W{constructor(e){super(e)}handle(e){n.debug("<DetachRequestHandler> Handling deattach reqeust message.");let t=new cr(e.id,e.client);try{this.configManager.makeSilent(),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(r){n.debug(`<DetachRequestHandler> An error occured while handling deattach reqeust message. ${r.message}`),t.setError(r)}finally{return t}}};var gt=class{constructor(e,t,r,o){this.requestHandlerMap=new Map([["PutTracePointRequest",new Ke(e)],["EnableTracePointRequest",new Ye(e)],["DisableTracePointRequest",new Je(e)],["RemoveTracePointRequest",new Ze(e)],["RemoveBatchTracePointRequest",new et(e)],["UpdateTracePointRequest",new tt(e)],["PutLogPointRequest",new rt(t)],["EnableLogPointRequest",new ot(t)],["DisableLogPointRequest",new it(t)],["RemoveLogPointRequest",new st(t)],["RemoveBatchLogPointRequest",new nt(t)],["UpdateLogPointRequest",new at(t)],["EnableProbeTagRequest",new ct(r)],["DisableProbeTagRequest",new lt(r)],["RemoveProbeTagRequest",new pt(r)],["UpdateConfigRequest",new ut(o)],["AttachRequest",new mt(o)],["DetachRequest",new dt(o)]])}getHandler(e){return this.requestHandlerMap.get(e.name)}};var ft=class{constructor(){this.eventHandlerMap=new Map([])}getHandler(e){return this.eventHandlerMap.get(e.name)}};var bt=class extends xe{constructor(e){super(e)}};var ht=class extends bt{constructor(e){super(e)}handle(e){n.debug(`<FilterTracePointsResponseHandler> Handling filter tracepoint message. ${e.requestId}`);try{let t=[];e.tracePoints.forEach(r=>{this.tracepointManager.putTracepoint({...r,id:r.id,fileName:this.extractFileName(r.fileName),lineNo:r.lineNo}),t.push(r.client)}),p.sendApplicationStatusEvent(),t.forEach(r=>{r&&p.sendApplicationStatusEvent(r)})}catch(t){n.debug(`<FilterTracePointsResponseHandler> An error occured while handling filter message. ${t.message}`)}}};var yt=class extends ve{constructor(e){super(e)}};var xt=class extends yt{constructor(e){super(e)}handle(e){n.debug(`<FilterLogPointsResponseHandler> Handling filter logpoint message. ${e.requestId}`);try{let t=[];e.logPoints.forEach(r=>{this.logpointManager.putLogpoint({...r,id:r.id,fileName:this.extractFileName(r.fileName),lineNo:r.lineNo})}),p.sendApplicationStatusEvent(),t.forEach(r=>{r&&p.sendApplicationStatusEvent(r)})}catch(t){n.debug(`<FilterLogPointsResponseHandler> An error occured while handling filter message. ${t.message}`)}}};var vt=class extends Ae{constructor(e){super(e)}};var At=class extends vt{constructor(e){super(e)}handle(e){n.debug(`<GetConfigResponseHandler> Handling get config response message. ${e.requestId}`);try{this.configManager.updateConfig(e.config),p.sendApplicationStatusEvent(),e.client&&p.sendApplicationStatusEvent(e.client)}catch(t){n.debug(`<GetConfigResponseHandler> An error occured while handling get config response message. ${t.message}`)}}};var Et=class{constructor(e,t,r){this.responseHandlerMap=new Map([["FilterTracePointsResponse",new ht(e)],["FilterLogPointsResponse",new xt(t)],["GetConfigResponse",new At(r)]])}getHandler(e){return this.responseHandlerMap.get(e.name)}};var Pt=class{constructor(e,t,r,o){this.handlerMap=new Map([["Request",new gt(e,t,r,o)],["Response",new Et(e,t,o)],["Event",new ft]])}getHandler(e){let t=this.handlerMap.get(e.type);if(!!t)return t.getHandler(e)}};var So=S(require("events")),Pr={STATUSCHANGED:"STATUSCHANGED"},Ct=class extends So.default{constructor(t){super();this.statusMap=t||new Map}getStatus(t){return this.statusMap.get(t)}setStatus(t,r){let o=this.statusMap.get(t);o!==void 0&&o==r||(this.statusMap.set(t,r),this.emit(Pr.STATUSCHANGED,{type:"ApiStatus",name:"StatusChanged",data:{[t]:r}}))}disableStatuses(){this.statusMap.forEach((t,r)=>{this.statusMap.set(r,!1)})}};var wt=class extends ye{constructor(t,r){super(r);this.bufferedCommunicationApi=t}listen(){return new Promise((t,r)=>{try{n.debug("<ApiStatusListener> Trying to listen api status ..."),this.apiStatus.on(Pr.STATUSCHANGED,this.onMessage),t()}catch(o){n.error("<ApiStatusListener> An error occured while to listen api status."),r(o)}})}unlisten(){n.debug("<ApiStatusListener> Unlisten api status."),this.apiStatus.removeListener(Pr.STATUSCHANGED,this.onMessage)}handleMessage(t){if(t.data){let r=!0;Object.keys(t.data).forEach(o=>{r&&!t.data[o]&&(r=!1)}),n.debug(`<ApiStatusListener> Api status will set to ${r}.`),r?this.bufferedCommunicationApi.unsilent():this.bufferedCommunicationApi.silent()}}};var Ro=require("timers");var Cr=class{constructor(e){this.tasks=[];this.schedulerTickCount=0;(e||[]).forEach(t=>{this.add(t.period,t.task)})}start(){this.interval=(0,Ro.setInterval)(()=>{try{this.schedulerTickCount>=Tr&&(this.schedulerTickCount=0),this.schedulerTickCount++;let e=[];this.tasks.forEach(t=>{this.schedulerTickCount%t.tickCount==0&&e.push(t.task.execute())}),Promise.all(e).then().catch(t=>{n.debug(`<TaskScheduler> An error occured while executing scheduled task. ${t.message}`)})}catch(e){n.debug(`<TaskScheduler> An error occured while task interval. ${this.schedulerTickCount} ${e.message}`)}},Bt*1e3),this.interval.unref()}add(e,t){let r=this.getTickCount(e);return r<1?!1:(this.tasks.push({tickCount:r,task:t}),!0)}stop(){clearInterval(this.interval),this.tasks=[]}getTickCount(e){let t=Math.round(e/Bt);return t<=Tr&&t>=1?t:-1}};var kt=class{constructor(e){this.probeStore=e}execute(){u.get(a.agent.silent)||this.probeStore.deleteExpiredProbes()}};var St=class{execute(){p.sendApplicationStatusEvent()}};var Rt=class{execute(){u.get(a.agent.silent)||p.sendRequest(R.createGetConfigRequest())}};var Lo=S(require("events"));var Io=S(require("p-queue"));var Or=class{constructor(){this.maxSize=u.get(a.taskExecutionQueue.maxSize),this.queue=[]}enqueue(e,t){this.size==this.maxSize-1&&this.dequeue,this.queue.push(e)}dequeue(){return this.queue.shift()}get size(){return this.queue.length}filter(e){return this.queue}},wr=class{constructor(e=5){this.queue=new Io.default({concurrency:e,queueClass:Or})}start(){this.queue.isPaused&&(n.debug("<TaskExecutorPQueue> Task executor service started."),this.queue.start())}pause(){this.queue.isPaused||(n.debug("<TaskExecutorPQueue> Task executor service paused."),this.queue.pause())}execute(e){return this.queue.add(e)}};var kr=class extends Lo.default{constructor(t){super();this.communicationApi=t,this.taskExecutorQueue=new wr(u.get(a.taskExecutionQueue.concurrency)),this.communicationApi.on(E.OPEN,r=>this._emit(E.OPEN,r)),this.communicationApi.on(E.ERROR,r=>this._emit(E.ERROR,r)),this.communicationApi.on(E.CLOSE,r=>this._emit(E.CLOSE,r)),this.communicationApi.on(E.MESSAGE,r=>this.onMessage(r)),this.unsilent()}connect(){this.communicationApi.connect(),this.connected=!0}reconnect(){this.connected=!1,this.communicationApi.reconnect(),this.connected=!0}close(){this.connected=!1,this.communicationApi.removeAllListeners(E.OPEN),this.communicationApi.removeAllListeners(E.ERROR),this.communicationApi.removeAllListeners(E.CLOSE),this.communicationApi.removeAllListeners(E.MESSAGE),this.communicationApi.close()}send(t){this.taskExecutorQueue&&this.taskExecutorQueue.execute(()=>{try{this.communicationApi.send(t)}catch(r){n.debug(`<DefaultBufferedCommunicationApi> An error occured while sending task. ${r.message}`)}})}silent(){this.taskExecutorQueue.pause()}unsilent(){this.taskExecutorQueue.start()}onMessage(t){this.taskExecutorQueue&&this.taskExecutorQueue.execute(()=>{try{this._emit(E.MESSAGE,t)}catch(r){n.debug(`<DefaultBufferedCommunicationApi> An error occured while emiting new message. ${r.message}`)}})}_emit(t,r){this.connected&&this.emit(t,r)}};var Sr=class{constructor(e){this.debugApi=e}getAll(e){let t=this.debugApi.getAll(),r=[];return(t||[]).forEach(o=>{if(o.type=="Tracepoint"){let s={id:o.rawId,fileName:o.remoteFilename||o.fileName,lineNo:o.lineNo,client:o.client,conditionExpression:o.condition,expireSecs:o.expireSecs,expireCount:o.expireCount,tracingEnabled:o.tracingEnabled,disabled:!o.enabled,fileHash:o.fileHash};e?o.client===e&&r.push(s):r.push(s)}}),r}putTracepoint(e){try{let t={...e,rawId:e.id,fileName:m.extractFileName(e.fileName),remoteFilename:e.fileName,type:"Tracepoint",enabled:!e.disable,tracingEnabled:e.tracingEnabled,...e.conditionExpression?{condition:e.conditionExpression}:void 0,actions:["ConditionAwareProbeAction","RateLimitedProbeAction",...e.tags?[]:["ExpiringProbeAction"]]};m.fillProbeId(t),m.fillClientDefault(t),m.fillExpireSecsDefault(t),m.fillExpireCountDefault(t),this.debugApi.add(t)}catch(t){n.debug(`<DefaultTracepointManager> An error occured while put tracepoint: ${t.message}`);let r=m.getCodedError(t,e);throw r||(r=m.getCodedErrorByName(N.name,e,t.message)),r}}updateTracePoint(e){let t={...e,rawId:e.id,type:"Tracepoint",enabled:!e.disable,tracingEnabled:e.tracingEnabled,...e.conditionExpression?{condition:e.conditionExpression}:void 0,actions:["ConditionAwareProbeAction","RateLimitedProbeAction",...e.tags?[]:["ExpiringProbeAction"]]};m.fillProbeId(t),m.fillClientDefault(t),m.fillExpireSecsDefault(t),m.fillExpireCountDefault(t);try{this.debugApi.update(t)}catch(r){n.debug(`<DefaultTracepointManager> An error occured while update tracepoint: ${r.message}`);let o=m.getCodedError(r,t);throw o||(o=m.getCodedErrorByName(j.name,t,r.message)),o}}removeTracePoint(e,t){let r={id:e,rawId:e,client:t,type:"Tracepoint"};m.fillProbeId(r),m.fillClientDefault(r);try{this.debugApi.delete(r)}catch(o){n.debug(`<DefaultTracepointManager> An error occured while remove tracepoint: ${o.message}`);let s=m.getCodedError(o,r);throw s||(s=m.getCodedErrorByName(B.name,r,o.message)),s}}enableTracePoint(e,t){let r={id:e,rawId:e,client:t,type:"Tracepoint"};m.fillProbeId(r),m.fillClientDefault(r);try{this.debugApi.enable(r)}catch(o){n.debug(`<DefaultTracepointManager> An error occured while enable tracepoint: ${o.message}`);let s=m.getCodedError(o,r);throw s||(s=m.getCodedErrorByName(q.name,r,o.message)),s}}disableTracePoint(e,t){let r={id:e,rawId:e,client:t,type:"Tracepoint"};m.fillProbeId(r),m.fillClientDefault(r);try{this.debugApi.disable(r)}catch(o){n.debug(`<DefaultTracepointManager> An error occured while disable tracepoint: ${o.message}`);let s=m.getCodedError(o,r);throw s||(s=m.getCodedErrorByName(O.name,r,o.message)),s}}};var Rr=class{constructor(e){this.debugApi=e}getAll(e){let t=this.debugApi.getAll(),r=[];return(t||[]).forEach(o=>{if(o.type=="Logpoint"){let s={id:o.rawId,fileName:o.remoteFilename||o.fileName,lineNo:o.lineNo,client:o.client,conditionExpression:o.condition,expireSecs:o.expireSecs,expireCount:o.expireCount,disabled:!o.enabled,fileHash:o.fileHash,logExpression:o.logExpression,logLevel:o.logLevel,stdoutEnabled:o.stdoutEnabled};e?o.client===e&&r.push(s):r.push(s)}}),r}putLogpoint(e){try{let t={...e,rawId:e.id,fileName:m.extractFileName(e.fileName),remoteFilename:e.fileName,type:"Logpoint",enabled:!e.disable,...e.conditionExpression?{condition:e.conditionExpression}:void 0,actions:["ConditionAwareProbeAction","RateLimitedProbeAction",...e.tags?[]:["ExpiringProbeAction"]]};m.fillProbeId(t),m.fillClientDefault(t),m.fillExpireSecsDefault(t),m.fillExpireCountDefault(t),this.debugApi.add(t)}catch(t){n.debug(`<DefaultLogpointManager> An error occured while put logpoint: ${t.message}`);let r=m.getCodedError(t,e);throw r||(r=m.getCodedErrorByName(N.name,e,t.message)),r}}updateLogPoint(e){let t={...e,rawId:e.id,type:"Logpoint",enabled:!e.disable,...e.conditionExpression?{condition:e.conditionExpression}:void 0,actions:["ConditionAwareProbeAction","RateLimitedProbeAction",...e.tags?[]:["ExpiringProbeAction"]]};m.fillProbeId(t),m.fillClientDefault(t),m.fillExpireSecsDefault(t),m.fillExpireCountDefault(t);try{this.debugApi.update(t)}catch(r){n.debug(`<DefaultLogpointManager> An error occured while update logpoint: ${r.message}`);let o=m.getCodedError(r,t);throw o||(o=m.getCodedErrorByName(j.name,t,r.message)),o}}removeLogPoint(e,t){let r={id:e,rawId:e,client:t,type:"Logpoint"};m.fillProbeId(r),m.fillClientDefault(r);try{this.debugApi.delete(r)}catch(o){n.debug(`<DefaultLogpointManager> An error occured while remove logpoint: ${o.message}`);let s=m.getCodedError(o,r);throw s||(s=m.getCodedErrorByName(B.name,r,o.message)),s}}enableLogPoint(e,t){let r={id:e,rawId:e,client:t,type:"Logpoint"};m.fillProbeId(r),m.fillClientDefault(r);try{this.debugApi.enable(r)}catch(o){n.debug(`<DefaultLogpointManager> An error occured while enable logpoint: ${o.message}`);let s=m.getCodedError(o,r);throw s||(s=m.getCodedErrorByName(q.name,r,o.message)),s}}disableLogPoint(e,t){let r={id:e,rawId:e,client:t,type:"Logpoint"};m.fillProbeId(r),m.fillClientDefault(r);try{this.debugApi.disable(r)}catch(o){n.debug(`<DefaultLogpointManager> An error occured while disable logpoint: ${o.message}`);let s=m.getCodedError(o,r);throw s||(s=m.getCodedErrorByName(O.name,r,o.message)),s}}};var Ir=class{constructor(e){this.debugApi=e}enableTag(e){(this.debugApi.getByTag(e)||[]).forEach(r=>{let o=this.debugApi.get(r);this.debugApi.enable(o)})}disableTag(e){(this.debugApi.getByTag(e)||[]).forEach(r=>{let o=this.debugApi.get(r);this.debugApi.disable(o)})}removeTag(e){this.debugApi.removeTag(e)}};var Lr=class{constructor(e){this.debugApi=e}makeSilent(){u.update({silent:!0}),this.debugApi.close()}makeUnsilent(){u.update({silent:!1}),this.debugApi.connect(),p.sendRequest(R.createTracepointFilterRequest()),p.sendRequest(R.createLogpointFilterRequest()),p.sendRequest(R.createGetConfigRequest())}updateConfig(e){u.update(e);let t=e.errorCollectionEnable;t!=null&&(t?this.debugApi.activateErrorCollection():this.debugApi.deactivateErrorCollection())}};var It=class{constructor(e){this.tracepointManager=e}provide(e,t){e.tracePoints=this.tracepointManager.getAll(t)}};var Lt=class{constructor(e){this.logpointManager=e}provide(e,t){e.logPoints=this.logpointManager.getAll(t)}};var Tt=class{constructor(e){this.debugApi=e}execute(){!u.get(a.agent.silent)&&u.get(a.errorCollection.enable)&&this.debugApi.enableErrorCollect()}};var Nt=class{constructor(){this.started=!1}start(){let e=this;return new Promise((t,r)=>{try{if(this.started)return n.info("<HeimdallManager> HeimdallManager already started."),t(e);let o=new se,s=new Ct(new Map);e.debugApi=new vr(o);let c=new I(I.generateBrokerUrl(u.get(a.broker.host),u.get(a.broker.port)),{headers:{...I.generateBrokerHeaders()}}),l=new kr(c);e.communicationApi=l;let d=new Sr(e.debugApi),g=new Rr(e.debugApi),x=new Ir(e.debugApi),f=new Lr(e.debugApi);p.setProviderList([new It(d),new Lt(g)]);let k=new Pt(d,g,x,f);e.debugApiListener=new Xe(e.debugApi,s),e.communicationApiListener=new Qe(e.communicationApi,k,e.debugApi,s),e.agentStatusListener=new wt(l,s),e.agentStatusListener.listen(),e.debugApiListener.listen(),e.communicationApiListener.listen().then(()=>{this.started=!0,e.initiateSchedular(o),n.info("<HeimdallManager> Agent started succesfully."),t(e)}).catch(b=>{n.error("<HeimdallManager> An error occured while starting agent.",b),r(b)})}catch(o){n.error("<HeimdallManager> An error occured while starting agent.",o),r(o)}})}stop(){this.started=!1,this.agentStatusListener.unlisten(),this.communicationApiListener.unlisten(),this.debugApiListener.unlisten(),this.scheduler.stop()}getDebugApi(){return this.debugApi}initiateSchedular(e){n.debug("<HeimdallManager> Initiate schedular working ..."),this.scheduler=new Cr([{period:30,task:new kt(e)},{period:60,task:new St},{period:30,task:new Tt(this.debugApi)},{period:300,task:new Rt}]),this.scheduler.start()}};var X=class{};X.getAvailableNumberValue=(e,t)=>e<h[t].min?h[t].default:e>h[t].max?h[t].max:e;var yi={[a.agent.apiKey]:{key:"apiKey",type:"string",required:!0},[a.agent.autoInstrumentation]:{key:"autoInstrumentation",type:"boolean",default:h[a.agent.silent].default},[a.broker.host]:{key:"brokerHost",type:"string",default:h[a.broker.host].default},[a.broker.port]:{key:"brokerPort",type:"number",default:h[a.broker.port].default},[a.agent.logLevel]:{key:"logLevel",type:"string",default:h[a.agent.logLevel].default},[a.agent.disable]:{key:"disable",type:"boolean",default:h[a.agent.disable].default},[a.agent.silent]:{key:"silent",type:"boolean",default:h[a.agent.silent].default},[a.application.tag]:{key:"applicationTag",type:"map"},[a.application.id]:{key:"applicationId",type:"string"},[a.application.name]:{key:"applicationName",type:"string",default:y.generateId()},[a.application.version]:{key:"applicationVersion",type:"string",default:"1.0.0"},[a.application.stage]:{key:"applicationStage",type:"string",default:"PROD"},[a.debugApi.resetV8Debugger]:{key:"resetV8Debugger",type:"boolean",default:h[a.debugApi.resetV8Debugger].default},[a.debugApi.resetV8DebuggerThreshold]:{key:"resetV8DebuggerThreshold",type:"number",default:h[a.debugApi.resetV8DebuggerThreshold].default},[a.debugApi.enableAsyncCallStack]:{key:"enableAsyncCallStack",type:"boolean",default:h[a.debugApi.enableAsyncCallStack].default},[a.debugApi.cleanupAsyncCallStackInterval]:{key:"cleanupAsyncCallstackInterval",type:"number",default:h[a.debugApi.cleanupAsyncCallStackInterval].default},[a.scriptStore.disablePositionCache]:{key:"disablePositionCache",type:"boolean",default:h[a.scriptStore.disablePositionCache].default},[a.scriptStore.whilelistModule]:{key:"whilelistModule",type:"array"},[a.scriptStore.hashCheckEnable]:{key:"hashCheckEnable",type:"boolean",default:h[a.scriptStore.hashCheckEnable].default},[a.rateLimit.inMinute]:{key:"inMinute",type:"number",default:h[a.rateLimit.inMinute].default},[a.capture.maxFrames]:{key:"maxFrames",type:"number",default:h[a.capture.maxFrames].default,get:i=>X.getAvailableNumberValue(i,a.capture.maxFrames)},[a.capture.maxExpandFrames]:{key:"maxExpandFrames",type:"number",default:h[a.capture.maxExpandFrames].default,get:i=>X.getAvailableNumberValue(i,a.capture.maxExpandFrames)},[a.capture.maxProperties]:{key:"maxProperties",type:"number",default:h[a.capture.maxProperties].default,get:i=>X.getAvailableNumberValue(i,a.capture.maxProperties)},[a.capture.maxParseDepth]:{key:"maxParseDepth",type:"number",default:h[a.capture.maxParseDepth].default,get:i=>X.getAvailableNumberValue(i,a.capture.maxParseDepth)},[a.capture.propertyAccessClassification]:{key:"propertyAccessClassification",type:"string",default:h[a.capture.propertyAccessClassification].default},[a.sourceCode.minified]:{key:"minified",type:"boolean",default:h[a.sourceCode.minified].default},[a.broker.client]:{key:"brokerClient",type:"string",default:h[a.broker.client].default},[a.taskExecutionQueue.concurrency]:{key:"tastExecutionQueueConcurrency",type:"number",default:h[a.taskExecutionQueue.concurrency].default},[a.taskExecutionQueue.maxSize]:{key:"tastExecutionQueueMaxSize",type:"number",default:h[a.taskExecutionQueue.maxSize].default},[a.agent.rejectOnStartup]:{key:"rejectOnStartup",type:"boolean",default:h[a.agent.rejectOnStartup].default},[a.scriptStore.prefix]:{key:"scriptPrefix",type:"string"},[a.dataReduction.captureFrame]:{key:"captureFrameDataReductionCallback",type:"function",canEnv:!1},[a.dataReduction.logMessage]:{key:"logMessageDataReductionCallback",type:"function",canEnv:!1},[a.errorCollection.enable]:{key:"errorCollectionEnable",type:"boolean",default:h[a.errorCollection.enable].default},[a.errorCollection.captureFrame]:{key:"errorCollectionEnableCaptureFrame",type:"boolean",default:h[a.errorCollection.captureFrame].default},[a.errorCollection.rateLimit.pointInMinute]:{key:"errorCollectionRateLimitPointInMinute",type:"number",default:h[a.errorCollection.rateLimit.pointInMinute].default},[a.errorCollection.rateLimit.totalInMinute]:{key:"errorCollectionRateLimitTotalInMinute",type:"number",default:h[a.errorCollection.rateLimit.totalInMinute].default}},To=yi;var Mt=class{constructor(e,t,r,o,s,c,l,d,g){this.applicationId=e,this.applicationInstanceId=t,this.applicationName=r,this.applicationVersion=o,this.applicationStage=s,this.applicationRuntime=c,this.hostname=l,this.applicationRuntimeVersion=d,this.applicationTags=g}};var Ee=class{};Ee.APPLICATION_RUNTIME="nodejs";var xi=require("os"),Dt=class extends Ee{constructor(){super();let t=xi.hostname(),r=u.get(a.application.name,t);this.applicationInfo=new Mt(u.get(a.application.id,`nodejs:${r}`),y.generateId(),r,u.get(a.application.version,""),u.get(a.application.stage,""),"nodejs",t,process.version,u.get(a.application.tag,{}))}getApplicationInfo(){return this.applicationInfo}};var No=S(require("path")),Mo=require("@opentelemetry/sdk-node"),Do=require("@opentelemetry/auto-instrumentations-node"),ae,vi=i=>{if(ae){n.error("<Heimdall> Debug Agent has already been started.");return}try{oe.statSync(No.join(process.cwd(),"package.json"))}catch(r){n.error("<Heimdall> No package.json located in working directory.",r);return}try{let r=oe.getActiveGitRepositoryName();u.init({config:i||{},configMetaData:To},r)}catch(r){n.error("<Heimdall> An error occured while parsing config.",r);return}if(u.get(a.agent.autoInstrumentation)&&new Mo.NodeSDK({instrumentations:[(0,Do.getNodeAutoInstrumentations)()]}).start(),u.get(a.agent.disable)){n.info("<Heimdall> Agent disabled.");return}w.setApplicationInfoProvider(new Dt);let e=u.get(a.agent.logLevel);n.setLogLevel(e),n.info("<Heimdall> Agent starting ..."),ae=new Nt;let t=ae.start();return u.get(a.agent.rejectOnStartup)||t.catch(()=>{}),t},Ai=()=>ae,Ei=()=>{ae&&(ae.stop(),ae=null)};0&&(module.exports={get,start,stop});
